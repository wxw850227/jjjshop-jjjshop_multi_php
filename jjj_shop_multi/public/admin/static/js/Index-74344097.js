import{f as e,E as a,e as t,b as s,h as l,v as o,i,d,j as n,k as c}from"./element-plus-a75e5680.js";import{s as r,a as p,d as h}from"./access-c7fcb5a4.js";import m from"./Edit-61a942bc.js";import u from"./Add-f1f61ef9.js";import{_,d as w}from"./index-07143257.js";import{c as f,a as g,O as k,R as y,_ as b,S as C,X as D,ad as j,o as v,V as S,W as M}from"./@vue-5c89b57d.js";import"./lodash-es-493ac664.js";import"./async-validator-cf877c1f.js";import"./@vueuse-85afefd9.js";import"./dayjs-4d201c0d.js";import"./@element-plus-ef0dbc7a.js";import"./@popperjs-b78c3215.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./request-8f5d2679.js";import"./axios-85bcd05e.js";import"./vue-router-2af8da50.js";import"./pinia-3964e703.js";import"./vue-demi-71ba0ef2.js";const V={class:"product"},F={class:"common-level-rail d-b-c"},T={class:"product-content"},x={class:"table-wrap"},z={key:0,class:"fb red f18"},A={key:1},E={key:0},L={key:1},U={key:2};const P=_({components:{Edit:m,Add:u},data:()=>({loading:!0,formSearch:{is_menu:!1,pack_up:!1},rawData:[],tableData:[],open_add:!1,add_type:"",selectModel:{},open_edit:!1,userModel:{}}),created(){this.getTableList()},methods:{changeIsMenuFunc(e){let a=w(this.rawData);e?(this.showScreen(a,1),this.tableData=a):this.tableData=a},isShowFunc(a){let t=this;r({access_id:a.access_id,status:a.is_show}).then((a=>{1==a.code&&(e({message:a.msg,type:"success"}),t.getTableList())})).catch((e=>{t.loading=!1}))},changePackUpFunc(e){this.forArr(this.tableData,!e)},forArr(e,a){e.forEach((e=>{this.$refs.theTable.toggleRowExpansion(e,a),e.children&&this.forArr(e.children,a)}))},changeShowFunc(e){let a=w(this.rawData);if("all"==e)this.tableData=a;else{let t;"show"==e&&(t=1),"hide"==e&&(t=0),this.showScreen(a,t),this.tableData=a}},showScreen(e,a){for(let t=0;t<e.length;t++){let s=e[t];void 0!==s.is_menu&&s.is_menu!=a?(e.splice(t,1),t--):s.children.length>0&&this.showScreen(s.children,a)}},getTableList(){let e=this;p({}).then((a=>{e.loading=!1,e.rawData=a.data,e.tableData=a.data})).catch((a=>{e.loading=!1}))},addClick(e,a){e&&void 0!==e?(this.add_type=a,this.selectModel=w(e)):this.parents_id=0,this.open_add=!0},editClick(e){this.selectModel=e,this.open_edit=!0},closeDialogFunc(e,a){"add"==a&&(this.open_add=e.openDialog,"success"==e.type&&this.getTableList()),"edit"==a&&(this.open_edit=e.openDialog,"success"==e.type&&this.getTableList())},deleteClick(t){let s=this;a.confirm("删除后不可恢复，确认删除该记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{s.loading=!0,h({access_id:t.access_id}).then((a=>{1==a.code&&(s.loading=!1,e({message:a.msg,type:"success"}),s.getTableList())})).catch((e=>{s.loading=!1}))})).catch((()=>{}))}}},[["render",function(e,a,r,p,h,m){const u=t,_=i,w=d,P=s,B=n,I=c,O=l,R=j("Add"),q=j("Edit"),Q=o;return v(),f("div",V,[g("div",F,[k(u,{type:"primary",onClick:m.addClick,icon:"Plus"},{default:y((()=>[S("添加菜单&权限")])),_:1},8,["onClick"]),k(P,{inline:!0,model:h.formSearch,size:"small"},{default:y((()=>[k(w,null,{default:y((()=>[k(_,{modelValue:h.formSearch.is_menu,"onUpdate:modelValue":a[0]||(a[0]=e=>h.formSearch.is_menu=e),onChange:m.changeIsMenuFunc},{default:y((()=>[S("只显示菜单")])),_:1},8,["modelValue","onChange"]),k(_,{modelValue:h.formSearch.pack_up,"onUpdate:modelValue":a[1]||(a[1]=e=>h.formSearch.pack_up=e),onChange:m.changePackUpFunc},{default:y((()=>[S("收起")])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1},8,["model"])]),g("div",T,[g("div",x,[g("div",null,[b((v(),C(O,{size:"small",data:h.tableData,style:{width:"100%","margin-bottom":"20px"},"row-key":"access_id",border:"","default-expand-all":"",ref:"theTable","tree-props":{children:"children"}},{default:y((()=>[k(B,{prop:"name",label:"菜单名称"},{default:y((e=>["/plus"==e.row.path?(v(),f("span",z,M(e.row.name),1)):(v(),f("span",A,M(e.row.name),1))])),_:1}),k(B,{prop:"path",label:"路径"}),k(B,{prop:"is_route",label:"类别",width:"90"},{default:y((e=>[1==e.row.is_route?(v(),f("span",E,"页面")):D("",!0),0==e.row.is_route?(v(),f("span",L,"按钮")):D("",!0),2==e.row.is_route?(v(),f("span",U,"独立单页面")):D("",!0)])),_:1}),k(B,{prop:"is_show",label:"是否显示",width:"80"},{default:y((e=>[k(I,{modelValue:e.row.is_show,"onUpdate:modelValue":a=>e.row.is_show=a,"active-value":1,"inactive-value":0,onChange:a=>m.isShowFunc(e.row),"active-color":"#13ce66","inactive-color":"#cccccc"},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),k(B,{prop:"sort",label:"排序",width:"60"}),k(B,{prop:"create_time",label:"添加时间",width:"140"}),k(B,{prop:"name",label:"操作",width:"230"},{default:y((e=>["/plus"!=e.row.path?(v(),C(u,{key:0,onClick:a=>m.addClick(e.row,"copy"),link:"",type:"primary",size:"small"},{default:y((()=>[S("一键复制")])),_:2},1032,["onClick"])):D("",!0),k(u,{onClick:a=>m.addClick(e.row,"child"),link:"",type:"primary",size:"small"},{default:y((()=>[S("添加子菜单")])),_:2},1032,["onClick"]),k(u,{onClick:a=>m.editClick(e.row),link:"",type:"primary",size:"small"},{default:y((()=>[S("编辑")])),_:2},1032,["onClick"]),"/plus"!=e.row.path?(v(),C(u,{key:1,onClick:a=>m.deleteClick(e.row),link:"",type:"primary",size:"small"},{default:y((()=>[S("删除")])),_:2},1032,["onClick"])):D("",!0)])),_:1})])),_:1},8,["data"])),[[Q,h.loading]])])])]),h.open_add?(v(),C(R,{key:0,open_add:h.open_add,add_type:h.add_type,rawData:h.rawData,selectModel:h.selectModel,onCloseDialog:a[2]||(a[2]=e=>m.closeDialogFunc(e,"add"))},null,8,["open_add","add_type","rawData","selectModel"])):D("",!0),h.open_edit?(v(),C(q,{key:1,open_edit:h.open_edit,rawData:h.rawData,selectModel:h.selectModel,onCloseDialog:a[3]||(a[3]=e=>m.closeDialogFunc(e,"edit"))},null,8,["open_edit","rawData","selectModel"])):D("",!0)])}]]);export{P as default};
