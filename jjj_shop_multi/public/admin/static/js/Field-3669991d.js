import{f as e,e as l,c as a,j as i,i as s,h as o,b as t,s as d,v as m}from"./element-plus-a75e5680.js";import{f as r,s as n}from"./message-7c65eb41.js";import{_ as p}from"./index-88c54a2c.js";import{o as u,S as f,R as c,O as _,V as h,a as g,_ as V}from"./@vue-5c89b57d.js";import"./lodash-es-493ac664.js";import"./async-validator-cf877c1f.js";import"./@vueuse-85afefd9.js";import"./dayjs-4d201c0d.js";import"./@element-plus-ef0dbc7a.js";import"./@popperjs-b78c3215.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./request-5f88d5f5.js";import"./axios-85bcd05e.js";import"./vue-router-2af8da50.js";import"./pinia-3964e703.js";import"./vue-demi-71ba0ef2.js";const j={class:"common-level-rail"},b={class:"table-wrap"};const w=p({data:()=>({formLabelWidth:"120px",dialogVisible:!1,title:"字段管理",fieldData:[],deleteIds:[],loading:!0}),props:["open_field","form"],created(){this.dialogVisible=this.open_field,this.title=this.title+"("+this.form.message_name+")",this.getFieldList()},methods:{getFieldList:function(){let e=this;r({message_id:e.form.message_id}).then((l=>{e.loading=!1,e.fieldData=l.data.list})).catch((l=>{e.loading=!1}))},saveField:function(){let l=this;n({message_id:l.form.message_id,fieldData:l.fieldData,deleteIds:l.deleteIds}).then((a=>{e({message:"恭喜你，修改成功",type:"success"}),l.dialogFormVisible(!0)})).catch((e=>{}))},addClick:function(){this.fieldData.push({message_field_id:0,message_id:this.form.message_id,field_name:"",field_ename:"",filed_value:"",sort:100})},deleteClick:function(e){let l=this.fieldData[e];l.message_field_id>0&&this.deleteIds.push(l.message_field_id),this.fieldData.splice(e,1)},checkRow:function(e,l){l.is_var=e?1:0},dialogFormVisible(e){e?this.$emit("closeDialog",{type:"success",openDialog:!1}):this.$emit("closeDialog",{type:"error",openDialog:!1})}}},[["render",function(e,r,n,p,w,k){const v=l,C=a,x=i,D=s,y=o,U=t,z=d,F=m;return u(),f(z,{title:w.title,modelValue:w.dialogVisible,"onUpdate:modelValue":r[0]||(r[0]=e=>w.dialogVisible=e),onClose:k.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:c((()=>[_(v,{onClick:k.dialogFormVisible},{default:c((()=>[h("取 消")])),_:1},8,["onClick"]),_(v,{type:"primary",onClick:k.saveField,loading:w.loading},{default:c((()=>[h("确 定")])),_:1},8,["onClick","loading"])])),default:c((()=>[g("div",j,[_(v,{size:"small",type:"primary",onClick:k.addClick},{default:c((()=>[h("添加字段")])),_:1},8,["onClick"])]),_(U,{size:"small"},{default:c((()=>[g("div",b,[V((u(),f(y,{border:"",data:w.fieldData},{default:c((()=>[_(x,{label:"字段名称",width:"120px"},{default:c((e=>[_(C,{size:"small",prop:"field_name",modelValue:e.row.field_name,"onUpdate:modelValue":l=>e.row.field_name=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),_(x,{label:"字段英文名",width:"130px"},{default:c((e=>[_(C,{size:"small",prop:"field_ename",modelValue:e.row.field_ename,"onUpdate:modelValue":l=>e.row.field_ename=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),_(x,{label:"字段默认值"},{default:c((e=>[_(C,{size:"small",prop:"filed_value",modelValue:e.row.filed_value,"onUpdate:modelValue":l=>e.row.filed_value=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),_(x,{label:"是否变量",width:"70px"},{default:c((e=>[_(D,{prop:"is_var",checked:1===e.row.is_var,onChange:l=>k.checkRow(l,e.row)},null,8,["checked","onChange"])])),_:1}),_(x,{label:"排序",width:"70px"},{default:c((e=>[_(C,{size:"small",prop:"sort",modelValue:e.row.sort,"onUpdate:modelValue":l=>e.row.sort=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),_(x,{fixed:"right",label:"操作",width:"70px"},{default:c((e=>[_(v,{onClick:l=>k.deleteClick(e.$index),type:"text",size:"small"},{default:c((()=>[h("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[F,w.loading]])])])),_:1})])),_:1},8,["title","modelValue","onClose"])}]]);export{w as default};
