System.register(["./element-plus-legacy-662cb951.js","./setting-legacy-4c2bfb73.js","./Area-legacy-fd051049.js","./index-legacy-7cb89a83.js","./@vue-legacy-3fcc10b7.js","./@vueuse-legacy-bdd63cbd.js","./lodash-es-legacy-7c31c52b.js","./async-validator-legacy-aa1fd2de.js","./dayjs-legacy-c5a98902.js","./call-bind-legacy-9803fab8.js","./get-intrinsic-legacy-4f34f38e.js","./has-symbols-legacy-afcc0593.js","./has-proto-legacy-d280ab1e.js","./function-bind-legacy-b76e1749.js","./has-legacy-06d86c07.js","./@element-plus-legacy-053c792c.js","./@popperjs-legacy-876caf52.js","./escape-html-legacy-ae962a8c.js","./normalize-wheel-es-legacy-13d39621.js","./@ctrl-legacy-33dbca08.js","./vue-router-legacy-b8d63bd7.js","./pinia-legacy-9b6e299c.js","./vue-demi-legacy-97cfbb01.js","./axios-legacy-40880ebd.js","./vue-ueditor-wrap-legacy-4eaef8ae.js","./qs-legacy-e8d8a27b.js","./side-channel-legacy-a0fabbd4.js","./object-inspect-legacy-50e036e0.js"],(function(e,a){"use strict";var l,t,r,n,i,o,u,d,s,c,f,m,p,h,y,g,v,_,w,b,j,k,V,x,C,A=document.createElement("style");return A.textContent=".el-table__header-wrapper{line-height:23px}.el-table .area-list{font-size:12px}.el-table .area-list .province{padding-right:10px;font-weight:700}.el-table .area-list .city{display:inline-block;white-space:nowrap;padding-right:4px;color:#999}\n",document.head.appendChild(A),{setters:[function(e){l=e.E,t=e.d,r=e.e,n=e.i,i=e.l,o=e.m,u=e.f,d=e.c},function(e){s=e.h,c=e.i},function(e){f=e.default},function(e){m=e._,p=e.d},function(e){h=e.ae,y=e.o,g=e.c,v=e.P,_=e.S,w=e.Y,b=e.a,j=e.W,k=e.Q,V=e.a9,x=e.X,C=e.T},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var a={components:{Area:f},data:function(){return{form:{delivery_id:0,method:"10",name:"",sort:1,radio:"10",rule:[]},formRules:{name:[{required:!0,message:" ",trigger:"blur"}]},loading:!1,options:[],optionsMap:{},areaModel:{},show_area:!1,tableHeadName:{first:"首件(个)",first_fee:"运费(元)",additional:"续件(个)",additional_fee:"续费(元)"},cityCount:0,formData:[]}},watch:{"form.radio":function(e,a){this.tableHeadName="10"==e?{first:"首件(个)",first_fee:"运费(元)",additional:"续件(个)",additional_fee:"续费(元)"}:{first:"首重(Kg)",first_fee:"运费(元)",additional:"续重(Kg)",additional_fee:"续费(元)"}},"form.rule":{handler:function(e,a){},deep:!0}},created:function(){this.delivery_id=this.$route.query.delivery_id,this.getData()},methods:{getData:function(){var e=this;s({delivery_id:e.delivery_id}).then((function(a){if(e.delivery_id>0&&(e.form=a.data.detail,e.form.rule=[],e.form.radio=e.form.method.value.toString(),e.formData=a.data.formData),e.options=a.data.arr,e.cityCount=a.data.cityCount,e.options.forEach((function(a){e.optionsMap[a.value]=a})),!e.formData.length)return!1;e.formData.forEach((function(a){for(var l in a.citys)a.citys.hasOwnProperty(l)&&(a.citys[l]=parseInt(a.citys[l]));a.showData=e.getShowData({province:a.province,citys:a.citys}),e.form.rule.push(a)}))})).catch((function(e){}))},getShowData:function(e){var a=this,l={};return e.province.forEach((function(t){var r=a.optionsMap[t],n=[],i=0;for(var o in r.children)if(r.children.hasOwnProperty(o)){var u=r.children[o];a.inArray(u.value,e.citys)&&n.push({id:u.value,name:u.label}),i++}l[r.value]={id:r.value,name:r.label,citys:n,isAllCitys:n.length===i}})),l},inArray:function(e,a){return a.indexOf(e)>-1},addAreaClick:function(e){this.areaModel.index=this.form.rule.length,this.areaModel.type="add",this.show_area=!0},editAreaClick:function(e){this.areaModel.index=e,this.areaModel.type="edit",this.show_area=!0},closeAreaFunc:function(e){if(this.show_area=e.statu,"confirm"==e.type){var a=[],l=[];e.this_area.forEach((function(e){a.push(e.value),e.children.forEach((function(e){l.push(e.value)}))})),"add"==this.areaModel.type&&this.form.rule.push({first:"",first_fee:"",additional:"",additional_fee:"",citys:l,showData:this.getShowData({province:a,citys:l})}),"edit"==this.areaModel.type&&(this.form.rule[this.areaModel.index].showData=this.getShowData({province:a,citys:l}),this.form.rule[this.areaModel.index].citys=l),this.form.rule.push([]),this.form.rule.pop()}},deleteAreaClick:function(e){var a=this;a.options.forEach((function(l){a.inArray(l.value,a.form.rule[e].province)&&(l.checked=!1,l.index=null),l.children.forEach((function(l){a.inArray(l.value,a.form.rule[e].citys)&&(l.checked=!1,l.index=null)}))})),a.form.rule.splice(e,1)},onSubmit:function(){var e=this,a=p(e.form);a.rule.forEach((function(e){delete e.showData})),e.$refs.form.validate((function(t){if(t){if(0==a.rule.length)return l({message:"请添加配送区域和运费",type:"error"}),!1;for(var r in a.rule){if(!(a.rule[r].hasOwnProperty("first")&&a.rule[r].first>0))return l({message:"首件/首重不能为空",type:"error"}),!1;if(!a.rule[r].hasOwnProperty("first_fee")||""==a.rule[r].first_fee)return l({message:"运费不能为空",type:"error"}),!1;if(!(a.rule[r].hasOwnProperty("additional")&&a.rule[r].additional>0))return l({message:"续件/续重不能为空",type:"error"}),!1;if(!a.rule[r].hasOwnProperty("additional_fee")||""==a.rule[r].additional_fee)return l({message:"续费不能为空",type:"error"}),!1}e.loading=!0,c(a).then((function(a){e.loading=!1,l({message:"恭喜你，修改成功",type:"success"}),e.$router.push("/setting/delivery/index")})).catch((function(a){e.loading=!1}))}}))}}},A={class:"product-add"},D={key:0,class:"common-form"},M={key:1,class:"common-form"},U={class:"area-list"},E={key:0},S={class:"am-link-muted gray9"},O={key:0},P=["onClick"],H=["onClick"],N=b("div",{class:"tips"},"数字越小越靠前",-1),$={class:"common-button-wrapper"};e("default",m(a,[["render",function(e,a,l,s,c,f){var m=t,p=r,q=n,z=i,R=o,F=u,K=d,I=h("Area");return y(),g("div",A,[v(K,{size:"small",ref:"form",model:c.form,rules:c.formRules,"label-width":"200px"},{default:_((function(){return[0==e.delivery_id?(y(),g("div",D,"新增运费模版")):w("",!0),e.delivery_id>0?(y(),g("div",M,"修改运费模版")):w("",!0),v(p,{label:"模版名称",prop:"name"},{default:_((function(){return[v(m,{modelValue:c.form.name,"onUpdate:modelValue":a[0]||(a[0]=function(e){return c.form.name=e}),class:"max-w460"},null,8,["modelValue"])]})),_:1}),v(p,{label:"计费方式"},{default:_((function(){return[b("div",null,[v(q,{modelValue:c.form.radio,"onUpdate:modelValue":a[1]||(a[1]=function(e){return c.form.radio=e}),label:"10"},{default:_((function(){return[j("按件数")]})),_:1},8,["modelValue"]),v(q,{modelValue:c.form.radio,"onUpdate:modelValue":a[2]||(a[2]=function(e){return c.form.radio=e}),label:"20"},{default:_((function(){return[j("按重量")]})),_:1},8,["modelValue"])])]})),_:1}),v(p,{label:"配送区域及运费"},{default:_((function(){return[v(R,{data:c.form.rule,border:"",style:{width:"100%"}},{default:_((function(){return[v(z,{label:"可配送区域"},{default:_((function(a){return[b("div",U,[a.row.citys.length==c.cityCount?(y(),g("span",E,"全国")):(y(!0),g(k,{key:1},V(a.row.showData,(function(e,a){return y(),g("span",{key:a,class:"pr16"},[j(x(e.name)+" ",1),e.isAllCitys?w("",!0):(y(),g(k,{key:0},[j(" ("),b("span",S,[(y(!0),g(k,null,V(e.citys,(function(a,l){return y(),g("em",{key:l},[b("span",null,x(a.name),1),l+1<e.citys.length?(y(),g("span",O,"、")):w("",!0)])})),128))]),j(") ")],64))])})),128))]),b("a",{href:"javascript:void(0);",onClick:function(l){return e.el=f.editAreaClick(a.$index)}},"编辑",8,P)]})),_:1}),v(z,{prop:"first",label:c.tableHeadName.first,width:"100px"},{default:_((function(e){return[v(m,{modelValue:e.row.first,"onUpdate:modelValue":function(a){return e.row.first=a}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1},8,["label"]),v(z,{prop:"first_fee",label:c.tableHeadName.first_fee,width:"100px"},{default:_((function(e){return[v(m,{modelValue:e.row.first_fee,"onUpdate:modelValue":function(a){return e.row.first_fee=a}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1},8,["label"]),v(z,{prop:"additional",label:c.tableHeadName.additional,width:"100px"},{default:_((function(e){return[v(m,{modelValue:e.row.additional,"onUpdate:modelValue":function(a){return e.row.additional=a}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1},8,["label"]),v(z,{prop:"additional_fee",label:c.tableHeadName.additional_fee,width:"100px"},{default:_((function(e){return[v(m,{modelValue:e.row.additional_fee,"onUpdate:modelValue":function(a){return e.row.additional_fee=a}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1},8,["label"]),v(z,{label:"操作",width:"60px"},{default:_((function(e){return[b("a",{href:"javascript:void(0);",onClick:function(a){return f.deleteAreaClick(e.$index)}},"删除",8,H)]})),_:1})]})),_:1},8,["data"]),b("div",null,[v(F,{onClick:f.addAreaClick,link:"",type:"primary",size:"small"},{default:_((function(){return[j("+点击添加可配送区域和运费")]})),_:1},8,["onClick"])])]})),_:1}),v(p,{label:"排序"},{default:_((function(){return[v(m,{modelValue:c.form.sort,"onUpdate:modelValue":a[3]||(a[3]=function(e){return c.form.sort=e}),type:"number",class:"max-w460"},null,8,["modelValue"]),N]})),_:1}),b("div",$,[v(F,{type:"primary",onClick:f.onSubmit,loading:c.loading},{default:_((function(){return[j("提交")]})),_:1},8,["onClick","loading"])])]})),_:1},8,["model","rules"]),c.show_area?(y(),C(I,{key:0,show_area:c.show_area,areaModel:c.areaModel,areas:c.options,onCloseArea:f.closeAreaFunc},null,8,["show_area","areaModel","areas","onCloseArea"])):w("",!0)])}]]))}}}));
