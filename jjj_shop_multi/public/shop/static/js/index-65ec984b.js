import{_ as e}from"./GetCoupon-e1a88380.js";import{_ as o}from"./Setlink-e64802a4.js";import{_ as l}from"./Upload-4b5e65e6.js";import{E as a,K as t,e as s,d as i,i as r,f as p,g as n,l as m,m as d,c as u}from"./element-plus-78c440b2.js";import{i as c,_ as f}from"./index-0e3e5afc.js";import{o as y,c as h,P as _,S as k,W as g,T as j,Y as b,a as x,X as V}from"./@vue-76da2f05.js";import"./coupon-08220fc3.js";import"./article-d609c59a.js";import"./product-edd059db.js";import"./@vueuse-90d34f35.js";import"./lodash-es-3f297d7c.js";import"./async-validator-cf877c1f.js";import"./dayjs-13b7e569.js";import"./call-bind-6a1b7bd0.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-9f5f6982.js";import"./@popperjs-b78c3215.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-590ae0e4.js";import"./pinia-58dabe83.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./vue-ueditor-wrap-cd890801.js";import"./qs-74887072.js";import"./side-channel-9348fcaa.js";import"./object-inspect-c71aff05.js";const C={components:{Upload:l,Setlink:o,GetCoupon:e},data:()=>({form:{is_open:!1,name:"",des:"查看详情",title:"",remark:"",link:"",type:"1",image_id:0,file_path:""},coupon:[],loading:!1,open_add:!1,isupload:!1,is_linkset:!1}),created(){this.getData()},computed:{linkText(){return this.form.link?"链接到"+this.form.link.type+" "+this.form.link.name:""}},methods:{openUpload(e){this.type=e,this.isupload=!0},returnImgsFunc(e){null!=e&&e.length>0&&(this.form.file_path=e[0].file_path,this.form.image_id=e[0].file_id),this.isupload=!1},getData(){let e=this;(async function(e){return c({url:"/shop/plus.homepush/index",method:"get",data:e})})().then((o=>{e.form=o.data.vars.values,"true"==e.form.is_open&&(e.form.is_open=!0),e.form.hasOwnProperty("coupon")?e.coupon=e.form.coupon:e.coupon=[]})).catch((e=>{}))},onSubmit(){let e=this,o=e.form;if(3==e.form.type&&(o.coupon=e.coupon),o.is_open&&!e.checkData(o))return!1;e.loading=!0,async function(e){return c({url:"/shop/plus.homepush/index",method:"post",data:e})}(o).then((o=>{e.loading=!1,1==o.code&&(a({message:"恭喜你，保存成功",type:"success"}),e.getData())})).catch((o=>{e.loading=!1}))},changeLink(){this.is_linkset=!0},closeLinkset(e){this.is_linkset=!1,this.form.link=e},addCoupon(){this.open_add=!0},closeProductDialogFunc(e){if(this.open_add=e.openDialog,this.coupon.length>=3)return a({message:"最多添加3张优惠券",type:"error"}),!1;if("success"==e.type){let o={};o.coupon_id=e.params.coupon_id,o.name=e.params.name,o.type=e.params.coupon_type.text,this.coupon.push(o)}},deleteCouponClick(e){this.coupon.splice(e,1)},checkData(e){if(1==e.type){if(!e.title)return a({message:"标题不能为空",type:"error"}),!1;if(!e.des||!e.remark)return!1}if(e.type<3){if(!e.link)return a({message:"请选择跳转链接",type:"error"}),!1}else if(0==e.coupon.length)return a({message:"请选择优惠卷",type:"error"}),!1;return e.image_id>0||(a({message:"请上传图片",type:"error"}),!1)}}},w={class:"pb50"},v=x("div",{class:"gray"}," 建议换活动，此名称更换，商城首页弹窗根据此名称不同来弹窗 ",-1),U={key:0},D={key:0,class:"img mt10"},q=["src"],z={class:"gray"},L={key:0},P={key:1},S={key:2},F={class:"btn-box"},I={class:"mt10 flex-1"},T={class:"fb orange"},G={class:"fb orange"},R={class:"common-button-wrapper"};const E=f(C,[["render",function(a,c,f,C,E,K){const M=t,O=s,W=i,X=r,Y=p,$=n,A=m,B=d,H=u,J=l,N=o,Q=e;return y(),h("div",w,[_(H,{size:"small",ref:"form",model:E.form,"label-width":"100px"},{default:k((()=>[_(O,{label:"开启首页推送",prop:"is_open"},{default:k((()=>[_(M,{modelValue:E.form.is_open,"onUpdate:modelValue":c[0]||(c[0]=e=>E.form.is_open=e)},null,8,["modelValue"])])),_:1}),_(O,{label:"活动名称",rules:[{required:!0,message:" "}],prop:"name"},{default:k((()=>[_(W,{class:"max-w460",modelValue:E.form.name,"onUpdate:modelValue":c[1]||(c[1]=e=>E.form.name=e),placeholder:"",type:"text"},null,8,["modelValue"]),v])),_:1}),E.form.is_open?(y(),h("div",U,[_(O,{label:"类型"},{default:k((()=>[_(X,{modelValue:E.form.type,"onUpdate:modelValue":c[2]||(c[2]=e=>E.form.type=e),label:"1"},{default:k((()=>[g("图文")])),_:1},8,["modelValue"]),_(X,{modelValue:E.form.type,"onUpdate:modelValue":c[3]||(c[3]=e=>E.form.type=e),label:"2"},{default:k((()=>[g("纯图")])),_:1},8,["modelValue"]),_(X,{modelValue:E.form.type,"onUpdate:modelValue":c[4]||(c[4]=e=>E.form.type=e),label:"3"},{default:k((()=>[g("领取优惠券")])),_:1},8,["modelValue"])])),_:1}),1==E.form.type?(y(),j(O,{key:0,label:"标题",rules:[{required:!0,message:" "}],prop:"title"},{default:k((()=>[_(W,{modelValue:E.form.title,"onUpdate:modelValue":c[5]||(c[5]=e=>E.form.title=e),placeholder:"请输入标题",class:"max-w460"},null,8,["modelValue"])])),_:1})):b("",!0),_(O,{label:"弹窗图片"},{default:k((()=>[_($,null,{default:k((()=>[_(Y,{icon:"Upload",onClick:K.openUpload},{default:k((()=>[g("选择图片")])),_:1},8,["onClick"]),E.form.image_id>0?(y(),h("div",D,[x("img",{src:E.form.file_path,width:"100",height:"100"},null,8,q)])):b("",!0)])),_:1}),x("div",z,[g(" 图片为2M以内大小，格式限png，jpg格式 "),1==E.form.type?(y(),h("span",L,"建议尺寸：600x300；")):b("",!0),2==E.form.type?(y(),h("span",P,"建议尺寸：600x420；")):b("",!0),3==E.form.type?(y(),h("span",S,"建议尺寸：600x250；")):b("",!0)])])),_:1}),1==E.form.type?(y(),j(O,{key:1,label:"按钮文案",rules:[{required:!0,message:" "}],prop:"des"},{default:k((()=>[_(W,{class:"max-w460",modelValue:E.form.des,"onUpdate:modelValue":c[6]||(c[6]=e=>E.form.des=e),placeholder:"",type:"text"},null,8,["modelValue"])])),_:1})):b("",!0),1==E.form.type?(y(),j(O,{key:2,label:"简介说明",rules:[{required:!0,message:" "}],prop:"remark"},{default:k((()=>[_(W,{type:"textarea",rows:2,max:"100",placeholder:"请输入说明",modelValue:E.form.remark,"onUpdate:modelValue":c[7]||(c[7]=e=>E.form.remark=e),class:"max-w460"},null,8,["modelValue"])])),_:1})):b("",!0),E.form.type<3?(y(),j(O,{key:3,label:"跳转地址",rules:[{required:!0,message:" "}],prop:"link"},{default:k((()=>[E.form.link?(y(),j(W,{key:0,class:"max-w460",placeholder:"点击选择你要链接的位置",modelValue:K.linkText,"onUpdate:modelValue":c[8]||(c[8]=e=>K.linkText=e),disabled:!0,style:{"margin-right":"10px"}},null,8,["modelValue"])):b("",!0),E.form.link?b("",!0):(y(),j(W,{key:1,class:"max-w460",placeholder:"点击选择你要链接的位置",disabled:!0,style:{"margin-right":"10px"}})),_(Y,{icon:"Link",onClick:K.changeLink},{default:k((()=>[g("选择链接")])),_:1},8,["onClick"])])),_:1})):b("",!0),3==E.form.type?(y(),j(O,{key:4,label:"选择优惠券"},{default:k((()=>[x("div",F,[_(Y,{size:"small",icon:"Plus",onClick:c[9]||(c[9]=e=>K.addCoupon())},{default:k((()=>[g("添加优惠券")])),_:1}),g(" （最多可以添加三张） ")])])),_:1})):b("",!0),3==E.form.type?(y(),j(O,{key:5},{default:k((()=>[x("div",I,[_(B,{size:"small",data:E.coupon,style:{width:"100%"}},{default:k((()=>[_(A,{prop:"name",label:"优惠券"},{default:k((e=>[x("span",T,V(e.row.name),1)])),_:1}),_(A,{prop:"name",label:"类型"},{default:k((e=>[x("span",G,V(e.row.type),1)])),_:1}),_(A,{label:"操作",width:"90"},{default:k((e=>[_(Y,{onClick:o=>K.deleteCouponClick(e.row.$index),link:"",type:"primary",size:"small"},{default:k((()=>[g("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])])),_:1})):b("",!0)])):b("",!0),x("div",R,[_(Y,{size:"small",type:"primary",onClick:K.onSubmit,loading:E.loading},{default:k((()=>[g("提交")])),_:1},8,["onClick","loading"])])])),_:1},8,["model"]),E.isupload?(y(),j(J,{key:0,isupload:E.isupload,type:a.type,onReturnImgs:K.returnImgsFunc},{default:k((()=>[g("上传图片")])),_:1},8,["isupload","type","onReturnImgs"])):b("",!0),E.is_linkset?(y(),j(N,{key:1,is_linkset:E.is_linkset,onCloseDialog:K.closeLinkset},{default:k((()=>[g("选择链接")])),_:1},8,["is_linkset","onCloseDialog"])):b("",!0),E.open_add?(y(),j(Q,{key:2,open_add:E.open_add,onCloseDialog:c[10]||(c[10]=e=>K.closeProductDialogFunc(e))},{default:k((()=>[g("选择优惠券弹出层")])),_:1},8,["open_add"])):b("",!0)])}]]);export{E as default};
