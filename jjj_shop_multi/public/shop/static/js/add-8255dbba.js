import{_ as e}from"./category-a7345ec9.js";import{_ as l}from"./Product-391f8ba4.js";import{E as a,t as o,u as t,d,e as r,i as s,A as i,s as u,f as m,l as p,m as c,y as n,h as _,c as f}from"./element-plus-78c440b2.js";import{a as y}from"./coupon-08220fc3.js";import{_ as g}from"./index-0e3e5afc.js";import{ap as b,o as h,c as V,P as j,S as k,Q as v,W as x,Y as C,T as U,$ as w,a as D,a9 as I,X as z,bb as F,b9 as N}from"./@vue-76da2f05.js";import"./product-edd059db.js";import"./@vueuse-90d34f35.js";import"./lodash-es-3f297d7c.js";import"./async-validator-cf877c1f.js";import"./dayjs-13b7e569.js";import"./call-bind-6a1b7bd0.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-9f5f6982.js";import"./@popperjs-b78c3215.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-590ae0e4.js";import"./pinia-58dabe83.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./vue-ueditor-wrap-cd890801.js";import"./qs-74887072.js";import"./side-channel-9348fcaa.js";import"./object-inspect-c71aff05.js";const P={components:{Product:l,Category:e},data:()=>({activeName:"1",form:{color:"10",coupon_type:"10",expire_type:"10",sort:1,active_time:"",show_center:1,apply_range:10},loading:!1,pickerOptions0:{disabledDate:e=>e.getTime()<Date.now()-864e5},is_category:!1,is_product:!1,exclude_ids:[],product_list:[],category_list:{second:[],first:[]},category_ids:[]}),created(){},methods:{onSubmit(){let e=this,l=e.form;l.product_ids=e.exclude_ids,l.category_list=e.category_list,e.$refs.form.validate((o=>{if(o){if(20==l.coupon_type&&(l.discount<=0||l.discount>=10))return void a({message:"折扣率介于0和10之间",type:"error"});e.loading=!0,y(l).then((l=>{e.loading=!1,a({message:"恭喜你，添加成功",type:"success"}),e.$router.push("/plus/coupon/index")})).catch((l=>{e.loading=!1}))}}))},closeCategoryFunc(e){let l=this;l.is_category=!1,e&&(l.category_list=e)},closeProductFunc(e){let l=this;l.is_product=e.openDialog,"success"==e.type&&e.params.forEach(((e,a)=>{let o={product_id:e.product_id,product_name:e.product_name,product_image:e.product_image};l.exclude_ids.push(o.product_id),l.product_list.push(o)}))},deleteClick(e){this.exclude_ids.splice(e,1),this.product_list.splice(e,1)},hasImages:e=>e||"",cancelFunc(){this.$router.push({path:"/plus/coupon/index"})}}},Y=e=>(F("data-v-91b2d05c"),e=e(),N(),e),$={class:"product-add"},q=Y((()=>D("div",{class:"common-form"},"添加优惠券",-1))),S=Y((()=>D("div",{class:"tips"},"例如：满100减10",-1))),E={key:0},M={key:1},O=Y((()=>D("div",{class:"tips"},"折扣率范围0-10，9.5代表9.5折，整数或1位小数",-1))),T={key:2},A={key:3},Q=Y((()=>D("div",{class:"tips"},"限制领取的优惠券数量，-1为不限制",-1))),W=Y((()=>D("div",{class:"common-form"},"适用商品",-1))),X=Y((()=>D("span",null,"指定商品",-1))),B=Y((()=>D("span",null,"指定分类",-1))),G={width:50,height:50},H={class:"common-button-wrapper"};const J=g(P,[["render",function(a,y,g,F,N,P){const Y=o,J=t,K=d,L=r,R=s,Z=i,ee=u,le=m,ae=p,oe=c,te=n,de=_,re=f,se=l,ie=e,ue=b("img-url");return h(),V("div",$,[j(re,{size:"small",ref:"form",model:N.form,"label-width":"200px"},{default:k((()=>[j(J,{modelValue:N.activeName,"onUpdate:modelValue":y[0]||(y[0]=e=>N.activeName=e),type:"card"},{default:k((()=>[j(Y,{label:"基本信息",name:"1"}),j(Y,{label:"适用商品",name:"2"})])),_:1},8,["modelValue"]),"1"==N.activeName?(h(),V(v,{key:0},[q,j(L,{label:"优惠券名称",prop:"name",rules:[{required:!0,message:" "}]},{default:k((()=>[j(K,{modelValue:N.form.name,"onUpdate:modelValue":y[1]||(y[1]=e=>N.form.name=e),placeholder:"请输入优惠券名称"},null,8,["modelValue"]),S])),_:1}),j(L,{label:"优惠券颜色"},{default:k((()=>[j(Z,{modelValue:N.form.color,"onUpdate:modelValue":y[2]||(y[2]=e=>N.form.color=e)},{default:k((()=>[j(R,{label:"10"},{default:k((()=>[x("蓝色")])),_:1}),j(R,{label:"20"},{default:k((()=>[x("红色")])),_:1}),j(R,{label:"30"},{default:k((()=>[x("紫色")])),_:1}),j(R,{label:"40"},{default:k((()=>[x("黄色")])),_:1})])),_:1},8,["modelValue"])])),_:1}),j(L,{label:"优惠券类型"},{default:k((()=>[j(Z,{modelValue:N.form.coupon_type,"onUpdate:modelValue":y[3]||(y[3]=e=>N.form.coupon_type=e)},{default:k((()=>[j(R,{label:"10"},{default:k((()=>[x("满减券")])),_:1}),j(R,{label:"20"},{default:k((()=>[x("折扣券")])),_:1})])),_:1},8,["modelValue"])])),_:1}),10==N.form.coupon_type?(h(),V("div",E,[j(L,{label:"减免金额"},{default:k((()=>[j(K,{modelValue:N.form.reduce_price,"onUpdate:modelValue":y[4]||(y[4]=e=>N.form.reduce_price=e),placeholder:"请输入减免金额",type:"number"},null,8,["modelValue"])])),_:1})])):(h(),V("div",M,[j(L,{label:"折扣率 "},{default:k((()=>[j(K,{modelValue:N.form.discount,"onUpdate:modelValue":y[5]||(y[5]=e=>N.form.discount=e),placeholder:"请输入折扣率",type:"number"},null,8,["modelValue"]),O])),_:1})])),j(L,{label:"最低消费金额"},{default:k((()=>[j(K,{modelValue:N.form.min_price,"onUpdate:modelValue":y[6]||(y[6]=e=>N.form.min_price=e),placeholder:"请输入最低消费金额",type:"number"},null,8,["modelValue"])])),_:1}),j(L,{label:"到期类型"},{default:k((()=>[j(Z,{modelValue:N.form.expire_type,"onUpdate:modelValue":y[7]||(y[7]=e=>N.form.expire_type=e)},{default:k((()=>[j(R,{label:"10"},{default:k((()=>[x("领取后生效")])),_:1}),j(R,{label:"20"},{default:k((()=>[x("固定时间")])),_:1})])),_:1},8,["modelValue"])])),_:1}),10==N.form.expire_type?(h(),V("div",T,[j(L,{label:"有效天数"},{default:k((()=>[j(K,{modelValue:N.form.expire_day,"onUpdate:modelValue":y[8]||(y[8]=e=>N.form.expire_day=e),placeholder:"请输入有效天数",type:"number"},null,8,["modelValue"])])),_:1})])):(h(),V("div",A,[j(L,{label:"有效时间"},{default:k((()=>[j(ee,{modelValue:N.form.active_time,"onUpdate:modelValue":y[9]||(y[9]=e=>N.form.active_time=e),type:"daterange",align:"right","unlink-panels":"","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":N.pickerOptions0},null,8,["modelValue","picker-options"])])),_:1})])),j(L,{label:"发放总数量 ",prop:"total_num",rules:[{required:!0,message:" "}]},{default:k((()=>[j(K,{modelValue:N.form.total_num,"onUpdate:modelValue":y[10]||(y[10]=e=>N.form.total_num=e),placeholder:"请输入发放总数量",type:"number"},null,8,["modelValue"]),Q])),_:1}),j(L,{label:"是否显示在领券中心"},{default:k((()=>[j(Z,{modelValue:N.form.show_center,"onUpdate:modelValue":y[11]||(y[11]=e=>N.form.show_center=e)},{default:k((()=>[j(R,{label:1},{default:k((()=>[x("显示")])),_:1}),j(R,{label:0},{default:k((()=>[x("不显示")])),_:1})])),_:1},8,["modelValue"])])),_:1}),j(L,{label:"排序"},{default:k((()=>[j(K,{type:"number",modelValue:N.form.sort,"onUpdate:modelValue":y[12]||(y[12]=e=>N.form.sort=e),placeholder:"请输入排序"},null,8,["modelValue"])])),_:1})],64)):C("",!0),"2"==N.activeName?(h(),V(v,{key:1},[W,j(L,{label:"选择"},{default:k((()=>[j(Z,{modelValue:N.form.apply_range,"onUpdate:modelValue":y[13]||(y[13]=e=>N.form.apply_range=e)},{default:k((()=>[j(R,{label:10},{default:k((()=>[x("全部商品")])),_:1}),j(R,{label:20},{default:k((()=>[X])),_:1}),j(R,{label:30},{default:k((()=>[B])),_:1})])),_:1},8,["modelValue"])])),_:1}),20==N.form.apply_range?(h(),U(L,{key:0},{default:k((()=>[j(le,{class:"mb10",onClick:y[14]||(y[14]=e=>N.is_product=!0),type:"primary",plain:""},{default:k((()=>[x("添加商品 ")])),_:1}),N.product_list.length>0?(h(),U(oe,{key:0,data:N.product_list,"max-height":"400",border:"",style:{width:"100%"}},{default:k((()=>[j(ae,{prop:"product_id",label:"ID",width:"180"}),j(ae,{prop:"product_name",label:"商品名称",width:"180"}),j(ae,{prop:"image",label:"图片"},{default:k((e=>[w(D("img",G,null,512),[[ue,P.hasImages(e.row.product_image)]])])),_:1}),j(ae,{label:"操作"},{default:k((e=>[j(le,{onClick:l=>P.deleteClick(e.$index),link:"",type:"primary",size:"small"},{default:k((()=>[x("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])):C("",!0)])),_:1})):C("",!0),30==N.form.apply_range?(h(),U(L,{key:1,label:""},{default:k((()=>[j(le,{class:"mb10",onClick:y[15]||(y[15]=e=>N.is_category=!0),type:"primary",plain:""},{default:k((()=>[x("添加分类 ")])),_:1}),j(de,null,{default:k((()=>[N.category_list.first.length>0?(h(!0),V(v,{key:0},I(N.category_list.first,((e,l)=>(h(),U(te,{class:"mr10 mb10",type:"info",size:"large",key:e.category_id},{default:k((()=>[x(z(e.parent?e.parent+"→"+e.name:e.name),1)])),_:2},1024)))),128)):C("",!0),N.category_list.second.length>0?(h(!0),V(v,{key:1},I(N.category_list.second,((e,l)=>(h(),U(te,{class:"mr10 mb10",type:"info",size:"large",key:e.category_id},{default:k((()=>[x(z(e.parent?e.parent+"→"+e.name:e.name),1)])),_:2},1024)))),128)):C("",!0)])),_:1})])),_:1})):C("",!0)],64)):C("",!0),D("div",H,[j(le,{type:"info",size:"small",onClick:P.cancelFunc,loading:N.loading},{default:k((()=>[x("取消")])),_:1},8,["onClick","loading"]),j(le,{type:"primary",size:"small",onClick:P.onSubmit,loading:N.loading},{default:k((()=>[x("提交")])),_:1},8,["onClick","loading"])])])),_:1},8,["model"]),j(se,{isproduct:N.is_product,excludeIds:N.exclude_ids,islist:!0,onCloseDialog:P.closeProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"]),j(ie,{is_category:N.is_category,excludeIds:N.category_ids,onClose:P.closeCategoryFunc},null,8,["is_category","excludeIds","onClose"])])}],["__scopeId","data-v-91b2d05c"]]);export{J as default};
