import{_ as e}from"./category-c9f65c60.js";import{_ as l}from"./Product-6d85ea8c.js";import{E as a,q as o,r as t,d,e as r,s,t as i,p as u,f as m,i as p,j as c,u as n,c as _}from"./element-plus-1d28f1d0.js";import{a as f}from"./coupon-eef4d6a0.js";import{_ as y}from"./index-3957abef.js";import{an as g,o as b,c as h,P as V,S as j,Q as v,W as k,Y as x,T as C,$ as U,a as w,a9 as D,X as I,bh as z,bf as F}from"./@vue-fcfaff04.js";import"./product-248f65bb.js";import"./lodash-es-493ac664.js";import"./async-validator-cf877c1f.js";import"./@vueuse-28c84072.js";import"./dayjs-3f6c138b.js";import"./call-bind-a6dd5c06.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-6c014c7f.js";import"./escape-html-d3e23fdb.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-0cda4647.js";import"./pinia-234ab43f.js";import"./axios-63583d02.js";import"./vue-ueditor-wrap-33bac798.js";import"./qs-edfbe083.js";import"./side-channel-6da5de8a.js";import"./object-inspect-66d569d0.js";const q={components:{Product:l,Category:e},data:()=>({activeName:"1",form:{color:"10",coupon_type:"10",expire_type:"10",sort:100,active_time:"",free_limit:0,apply_range:10,product:[]},loading:!1,pickerOptions0:{disabledDate:e=>e.getTime()<Date.now()-864e5},prodcutData:[],exclude_ids:[],isproduct:!1,is_category:!1,is_product:!1,product_list:[],category_list:{second:[],first:[]},category_ids:[]}),created(){},methods:{onSubmit(){let e=this,l=e.form;l.product_ids=e.exclude_ids,l.category_list=e.category_list,e.$refs.form.validate((o=>{if(o){if(20==l.coupon_type&&(l.discount<=0||l.discount>=10))return void a({message:"折扣率介于0和10之间",type:"error"});e.loading=!0,f(l).then((l=>{e.loading=!1,a({message:"恭喜你，添加成功",type:"success"}),e.$router.push("/coupon/coupon/index")})).catch((l=>{e.loading=!1}))}}))},closeCategoryFunc(e){let l=this;l.is_category=!1,e&&(l.category_list=e)},closeProductFunc(e){let l=this;l.is_product=e.openDialog,"success"==e.type&&e.params.forEach(((e,a)=>{let o={product_id:e.product_id,product_name:e.product_name,product_image:e.image};l.exclude_ids.push(o.product_id),l.product_list.push(o)}))},deleteClick(e){this.exclude_ids.splice(e,1),this.product_list.splice(e,1)},hasImages:e=>e||"",cancelFunc(){this.$router.push({path:"/coupon/coupon/index"})}}},N=e=>(z("data-v-f0be5e19"),e=e(),F(),e),P={class:"product-add"},Y=N((()=>w("div",{class:"common-form"},"添加优惠券",-1))),$=N((()=>w("div",{class:"tips"},"例如：满100减10",-1))),S={key:0},E={key:1},M=N((()=>w("div",{class:"tips"},"折扣率范围0-10，9.5代表9.5折，整数或1位小数",-1))),O={key:2},T={key:3},Q=N((()=>w("div",{class:"tips"},"限制领取的优惠券数量，-1为不限制",-1))),W=N((()=>w("div",{class:"tips"},"促销是指满减，等级优惠券值商品的会员等级折扣",-1))),X=N((()=>w("div",{class:"common-form"},"适用商品",-1))),A=N((()=>w("span",null,"指定商品",-1))),B=N((()=>w("span",null,"指定分类",-1))),G={alt:"",width:50},H={class:"ww100"},J={class:"common-button-wrapper"};const K=y(q,[["render",function(a,f,y,z,F,q){const N=o,K=t,L=d,R=r,Z=s,ee=i,le=u,ae=m,oe=p,te=c,de=n,re=_,se=l,ie=e,ue=g("img-url");return b(),h("div",P,[V(re,{size:"small",ref:"form",model:F.form,"label-width":"200px"},{default:j((()=>[V(K,{modelValue:F.activeName,"onUpdate:modelValue":f[0]||(f[0]=e=>F.activeName=e),type:"card"},{default:j((()=>[V(N,{label:"基本信息",name:"1"}),V(N,{label:"适用商品",name:"2"})])),_:1},8,["modelValue"]),"1"==F.activeName?(b(),h(v,{key:0},[Y,V(R,{label:"优惠券名称",prop:"name",rules:[{required:!0,message:" "}]},{default:j((()=>[V(L,{modelValue:F.form.name,"onUpdate:modelValue":f[1]||(f[1]=e=>F.form.name=e),placeholder:"请输入优惠券名称"},null,8,["modelValue"]),$])),_:1}),V(R,{label:"优惠券颜色"},{default:j((()=>[V(ee,{modelValue:F.form.color,"onUpdate:modelValue":f[2]||(f[2]=e=>F.form.color=e)},{default:j((()=>[V(Z,{label:"10"},{default:j((()=>[k("蓝色")])),_:1}),V(Z,{label:"20"},{default:j((()=>[k("红色")])),_:1}),V(Z,{label:"30"},{default:j((()=>[k("紫色")])),_:1}),V(Z,{label:"40"},{default:j((()=>[k("黄色")])),_:1})])),_:1},8,["modelValue"])])),_:1}),V(R,{label:"优惠券类型"},{default:j((()=>[V(ee,{modelValue:F.form.coupon_type,"onUpdate:modelValue":f[3]||(f[3]=e=>F.form.coupon_type=e)},{default:j((()=>[V(Z,{label:"10"},{default:j((()=>[k("满减券")])),_:1}),V(Z,{label:"20"},{default:j((()=>[k("折扣券")])),_:1})])),_:1},8,["modelValue"])])),_:1}),10==F.form.coupon_type?(b(),h("div",S,[V(R,{label:"减免金额"},{default:j((()=>[V(L,{modelValue:F.form.reduce_price,"onUpdate:modelValue":f[4]||(f[4]=e=>F.form.reduce_price=e),placeholder:"请输入减免金额",type:"number"},null,8,["modelValue"])])),_:1})])):(b(),h("div",E,[V(R,{label:"折扣率 "},{default:j((()=>[V(L,{modelValue:F.form.discount,"onUpdate:modelValue":f[5]||(f[5]=e=>F.form.discount=e),placeholder:"请输入折扣率",type:"number"},null,8,["modelValue"]),M])),_:1})])),V(R,{label:"最低消费金额"},{default:j((()=>[V(L,{modelValue:F.form.min_price,"onUpdate:modelValue":f[6]||(f[6]=e=>F.form.min_price=e),placeholder:"请输入最低消费金额",type:"number"},null,8,["modelValue"])])),_:1}),V(R,{label:"到期类型"},{default:j((()=>[V(ee,{modelValue:F.form.expire_type,"onUpdate:modelValue":f[7]||(f[7]=e=>F.form.expire_type=e)},{default:j((()=>[V(Z,{label:"10"},{default:j((()=>[k("领取后生效")])),_:1}),V(Z,{label:"20"},{default:j((()=>[k("固定时间")])),_:1})])),_:1},8,["modelValue"])])),_:1}),10==F.form.expire_type?(b(),h("div",O,[V(R,{label:"有效天数"},{default:j((()=>[V(L,{modelValue:F.form.expire_day,"onUpdate:modelValue":f[8]||(f[8]=e=>F.form.expire_day=e),placeholder:"请输入有效天数",type:"number"},null,8,["modelValue"])])),_:1})])):(b(),h("div",T,[V(R,{label:"有效时间"},{default:j((()=>[V(le,{modelValue:F.form.active_time,"onUpdate:modelValue":f[9]||(f[9]=e=>F.form.active_time=e),type:"daterange",align:"right","unlink-panels":"","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":F.pickerOptions0},null,8,["modelValue","picker-options"])])),_:1})])),V(R,{label:"发放总数量 ",prop:"total_num",rules:[{required:!0,message:" "}]},{default:j((()=>[V(L,{modelValue:F.form.total_num,"onUpdate:modelValue":f[10]||(f[10]=e=>F.form.total_num=e),placeholder:"请输入发放总数量",type:"number"},null,8,["modelValue"]),Q])),_:1}),V(R,{label:"使用条件"},{default:j((()=>[V(ee,{modelValue:F.form.free_limit,"onUpdate:modelValue":f[11]||(f[11]=e=>F.form.free_limit=e)},{default:j((()=>[V(Z,{label:0},{default:j((()=>[k("不限制")])),_:1}),V(Z,{label:1},{default:j((()=>[k("不可与促销同时使用")])),_:1}),V(Z,{label:2},{default:j((()=>[k("不可与等级优惠同时使用")])),_:1}),V(Z,{label:3},{default:j((()=>[k("不可于促销和等级优惠同时使用")])),_:1})])),_:1},8,["modelValue"]),W])),_:1}),V(R,{label:"排序"},{default:j((()=>[V(L,{type:"number",modelValue:F.form.sort,"onUpdate:modelValue":f[12]||(f[12]=e=>F.form.sort=e),placeholder:"请输入排序"},null,8,["modelValue"])])),_:1})],64)):x("",!0),"2"==F.activeName?(b(),h(v,{key:1},[X,V(R,{label:"选择"},{default:j((()=>[V(ee,{modelValue:F.form.apply_range,"onUpdate:modelValue":f[13]||(f[13]=e=>F.form.apply_range=e)},{default:j((()=>[V(Z,{label:10},{default:j((()=>[k("全部商品")])),_:1}),V(Z,{label:20},{default:j((()=>[A])),_:1}),V(Z,{label:30},{default:j((()=>[B])),_:1})])),_:1},8,["modelValue"])])),_:1}),20==F.form.apply_range?(b(),C(R,{key:0},{default:j((()=>[V(ae,{class:"mb10",onClick:f[14]||(f[14]=e=>F.is_product=!0),type:"primary",plain:""},{default:j((()=>[k("添加商品 ")])),_:1}),F.product_list.length>0?(b(),C(te,{key:0,data:F.product_list,"max-height":"400",border:"",style:{width:"100%"}},{default:j((()=>[V(oe,{prop:"product_id",label:"ID",width:"180"}),V(oe,{prop:"product_name",label:"商品名称",width:"180"}),V(oe,{prop:"image",label:"图片"},{default:j((e=>[U(w("img",G,null,512),[[ue,q.hasImages(e.row.product_image)]])])),_:1}),V(oe,{label:"操作"},{default:j((e=>[V(ae,{onClick:l=>q.deleteClick(e.$index),link:"",type:"primary",size:"small"},{default:j((()=>[k("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])):x("",!0)])),_:1})):x("",!0),30==F.form.apply_range?(b(),C(R,{key:1,label:""},{default:j((()=>[V(ae,{class:"mb10",onClick:f[15]||(f[15]=e=>F.is_category=!0),type:"primary",plain:""},{default:j((()=>[k("添加分类 ")])),_:1}),w("div",H,[F.category_list.first.length>0?(b(!0),h(v,{key:0},D(F.category_list.first,((e,l)=>(b(),C(de,{class:"mr10 mb10",type:"info",size:"large",key:e.category_id},{default:j((()=>[k(I(e.parent?e.parent+"→"+e.name:e.name),1)])),_:2},1024)))),128)):x("",!0),F.category_list.second.length>0?(b(!0),h(v,{key:1},D(F.category_list.second,((e,l)=>(b(),C(de,{class:"mr10 mb10",type:"info",size:"large",key:e.category_id},{default:j((()=>[k(I(e.parent?e.parent+"→"+e.name:e.name),1)])),_:2},1024)))),128)):x("",!0)])])),_:1})):x("",!0)],64)):x("",!0),w("div",J,[V(ae,{type:"info",size:"small",onClick:q.cancelFunc},{default:j((()=>[k("取消")])),_:1},8,["onClick"]),V(ae,{type:"primary",size:"small",onClick:q.onSubmit,loading:F.loading},{default:j((()=>[k("提交")])),_:1},8,["onClick","loading"])])])),_:1},8,["model"]),V(se,{isproduct:F.is_product,excludeIds:F.exclude_ids,islist:!0,onCloseDialog:q.closeProductFunc},null,8,["isproduct","excludeIds","onCloseDialog"]),V(ie,{is_category:F.is_category,excludeIds:F.category_ids,onClose:q.closeCategoryFunc},null,8,["is_category","excludeIds","onClose"])])}],["__scopeId","data-v-f0be5e19"]]);export{K as default};
