import{_ as e,z as s,B as a,o as t,c,w as l,f as o,h as i,d,g as n,r,F as u,e as f,j as _,a9 as p,l as m,t as g,n as h,i as b,k as v,a5 as k}from"./index-73db7405.js";import D from"./components-upload-upload.5dc72dfa.js";const x=e({components:{Upload:D},data:()=>({loadding:!0,order_id:"",tableData:[],score:10,isUpload:!1,image_id:[],img:"/static/temp/photo.jpg",index:"",service:[],logistics:[],describe:[]}),onLoad(e){this.order_id=e.order_id},mounted(){s({title:"加载中"}),this.getData()},methods:{getData(){let e=this,s=e.order_id;e._get("user.comment/order",{order_id:s},(function(s){e.tableData=s.data.productList,e.tableData.forEach(((s,a)=>{e.tableData[a].score=10,e.tableData[a].image_list=[],e.service.push([!1,!1,!1,!1,!1]),e.logistics.push([!1,!1,!1,!1,!1]),e.describe.push([!1,!1,!1,!1,!1])})),e.loadding=!1,a()}))},gradeFunc(e,s,a){e.score=s,this.$set(this.tableData,a,e),console.log(this.tableData)},chooseLog(e,s){let a=this;a.tableData[s].express_score=0,this.logistics[s].forEach(((t,c)=>{c<=e?(this.logistics[s].splice(c,1,!0),a.tableData[s].express_score++):this.logistics[s].splice(c,1,!1)}))},chooseServ(e,s){let a=this;a.tableData[s].server_score=0,this.service[s].forEach(((t,c)=>{c<=e?(this.service[s].splice(c,1,!0),a.tableData[s].server_score++):this.service[s].splice(c,1,!1)})),console.log(a.tableData)},choosees(e,s){let a=this;a.tableData[s].describe_score=0,this.describe[s].forEach(((t,c)=>{c<=e?(this.describe[s].splice(c,1,!0),a.tableData[s].describe_score++):this.describe[s].splice(c,1,!1)})),console.log(a.tableData)},formSubmit:function(e){let s=this,a=s.order_id,t=[];this.tableData.forEach(((e,s)=>{t[s]={order_product_id:e.order_product_id,product_id:e.product_id,score:e.score,image_list:e.image_list,express_score:e.express_score,server_score:e.server_score,describe_score:e.describe_score,content:""},e.content&&(t[s].content=e.content)})),console.log(t),s._post("user.comment/order",{order_id:a,formData:JSON.stringify(t)},(function(e){s.showSuccess("评价成功！",(function(){s.gotoPage("/pages/order/myorder","redirect")}))}))},openUpload(e){this.isUpload=!1,this.index=e,this.isUpload=!0},getImgsFunc(e){let s=this;if(e&&void 0!==e){let a=s.index;s.tableData[a].image_list=s.tableData[a].image_list.concat(e)}s.isUpload=!1},deleteImg(e,s){let a=this.tableData[e];a.image_list.splice(s,1),this.$set(this.tableData,e,a)}}},[["render",function(e,s,a,D,x,C){const y=b,U=i,F=v,j=k,S=_,I=p,E=m("Upload");return x.loadding?o("",!0):(t(),c(U,{key:0,class:"evaluate pb100"},{default:l((()=>[d(I,{onSubmit:C.formSubmit,onReset:e.formReset},{default:l((()=>[(t(!0),n(u,null,r(x.tableData,((e,s)=>(t(),c(U,{class:"evaluate-item p30",key:s},{default:l((()=>[d(U,{class:"product d-s-c"},{default:l((()=>[d(U,{class:"cover"},{default:l((()=>[d(y,{src:e.image.file_path,mode:"aspectFit"},null,8,["src"])])),_:2},1024),d(U,{class:"info ml20"},{default:l((()=>[d(U,{class:"name f28"},{default:l((()=>[f(g(e.product_name),1)])),_:2},1024),d(U,{class:"price pt10 f22 red"},{default:l((()=>[f(" ¥ "),d(F,{class:"f40"},{default:l((()=>[f(g(e.product_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(U,{class:"grade evalu p-30-0 mt30"},{default:l((()=>[d(U,{class:"evalu-value"},{default:l((()=>[f(" 描述相符： "),d(U,{class:"eval"},{default:l((()=>[(t(!0),n(u,null,r(x.describe[s],((e,a)=>(t(),n("i",{key:a,class:h(e?"icon iconfont icon-start":"icon iconfont icon-start1"),onClick:e=>C.choosees(a,s)},null,10,["onClick"])))),128))])),_:2},1024)])),_:2},1024),d(U,{class:"evalu-value"},{default:l((()=>[f(" 服务态度： "),d(U,{class:"eval"},{default:l((()=>[(t(!0),n(u,null,r(x.service[s],((e,a)=>(t(),n("i",{key:a,class:h(e?"icon iconfont icon-start":"icon iconfont icon-start1"),onClick:e=>C.chooseServ(a,s)},null,10,["onClick"])))),128))])),_:2},1024)])),_:2},1024),d(U,{class:"evalu-value"},{default:l((()=>[f(" 配送服务： "),d(U,{class:"eval"},{default:l((()=>[(t(!0),n(u,null,r(x.logistics[s],((e,a)=>(t(),n("i",{key:a,class:h(e?"icon iconfont icon-start":"icon iconfont icon-start1"),onClick:e=>C.chooseLog(a,s)},null,10,["onClick"])))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024),d(U,{class:"grade d-a-c p-30-0 mt30"},{default:l((()=>[d(U,{class:h(10==e.score?"flex-1 d-c-c active":"flex-1 d-c-c"),onClick:a=>C.gradeFunc(e,10,s)},{default:l((()=>[d(U,{class:"item d-c-c"},{default:l((()=>[d(F,{class:"icon iconfont icon-pingjiahaoping"}),d(F,{class:"ml10"},{default:l((()=>[f("好评")])),_:1})])),_:1})])),_:2},1032,["class","onClick"]),d(U,{class:h(20==e.score?"flex-1 d-c-c active":"flex-1 d-c-c"),onClick:a=>C.gradeFunc(e,20,s)},{default:l((()=>[d(U,{class:"item d-c-c"},{default:l((()=>[d(F,{class:"icon iconfont icon-pingjiazhongping"}),d(F,{class:"ml10"},{default:l((()=>[f("中评")])),_:1})])),_:1})])),_:2},1032,["class","onClick"]),d(U,{class:h(30==e.score?"flex-1 d-c-c active":"flex-1 d-c-c"),onClick:a=>C.gradeFunc(e,30,s)},{default:l((()=>[d(U,{class:"item d-c-c"},{default:l((()=>[d(F,{class:"icon iconfont icon-pingjiachaping"}),d(F,{class:"ml10"},{default:l((()=>[f("差评")])),_:1})])),_:1})])),_:2},1032,["class","onClick"])])),_:2},1024),d(U,{class:"textarea-box d-s-c f28"},{default:l((()=>[d(j,{class:"p10 box-s-b border flex-1",modelValue:e.content,"onUpdate:modelValue":s=>e.content=s,placeholder:"请输入评价内容"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),d(U,{class:"upload-list d-s-c"},{default:l((()=>[(t(!0),n(u,null,r(e.image_list,((e,a)=>(t(),c(U,{class:"item",key:a,onClick:e=>C.deleteImg(s,a)},{default:l((()=>[d(y,{src:e.file_path,mode:"aspectFit"},null,8,["src"])])),_:2},1032,["onClick"])))),128)),e.image_list.length<9?(t(),c(U,{key:0,class:"item upload-btn d-c-c d-c",onClick:e=>C.openUpload(s)},{default:l((()=>[d(F,{class:"icon iconfont icon-xiangji"}),d(F,{class:"gray9"},{default:l((()=>[f("上传图片")])),_:1})])),_:2},1032,["onClick"])):o("",!0)])),_:2},1024)])),_:2},1024)))),128)),d(U,{class:"foot-btns"},{default:l((()=>[d(S,{"form-type":"submit",class:"btn-red"},{default:l((()=>[f("确认提交")])),_:1})])),_:1})])),_:1},8,["onSubmit","onReset"]),x.isUpload?(t(),c(E,{key:0,onGetImgs:C.getImgsFunc},null,8,["onGetImgs"])):o("",!0)])),_:1}))}],["__scopeId","data-v-24c2d4e5"]]);export{x as default};
