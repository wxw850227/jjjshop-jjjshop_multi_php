import{_ as e,N as a,ai as t,z as c,B as s,o,c as r,w as d,n as l,h as i,d as n,e as p,t as y,g as u,r as _,F as h,k as f,a4 as m,j as g,f as b}from"./index-73db7405.js";import{p as k}from"./pay.2338ad0e.js";const P=e({data:()=>({balance:"",balanceType:!0,type:0,loading:!0,order_id:0,order_type:0,pay_type:20,checkedPay:[],payPrice:"",isPay:!1}),computed:{hasBanlance(){if(40==this.order_type||this.balance<=0)return!1;return-1!=this.checkedPay.indexOf(10)}},onLoad(e){this.order_id=decodeURIComponent(e.order_id),e.order_type&&(this.order_type=e.order_type),this.getData()},onBackPress(e){if(console.log(!this.isPay),!this.isPay&&20!=this.order_type&&30!=this.order_type&&40!=this.order_type)return"navigateBack"===e.from||this.back(),!0},methods:{back(){let e=this;a({title:"提示",content:"您的订单如在规定时间内未支付将被取消，请尽快完成支付",cancelText:"继续支付",confirmText:"确认离开",success:function(a){a.confirm?t({url:"/pages/order/order-detail?order_id="+e.order_id}):a.cancel&&console.log("用户点击取消")}})},getTheme(){let e="#ff5704";switch(this.theme()){case"theme0":e="#ff5704";break;case"theme1":e="#19ad57";break;case"theme2":e="#ffcc00";break;case"theme3":e="#33a7ff";break;case"theme4":e="#e4e4e4";break;case"theme5":e="#c8ba97";break;case"theme6":e="#623ceb"}return e},getData(){let e=this;e.loading=!0,c({title:"加载中"});let a="user.order/pay";20==e.order_type&&(a="supplier.index/pay"),30==e.order_type&&(a="plus.live.plan/pay"),40==e.order_type&&(a="balance.plan/pay"),50==e.order_type&&(a="plus.advance.Order/pay");let t={order_id:e.order_id,pay_source:e.getPlatform()};e._get(a,t,(function(a){e.loading=!1;let t=[];a.data.payTypes.forEach((e=>{t.push(1*e)})),e.checkedPay=t,e.payPrice=a.data.payPrice,e.balance=a.data.balance||"",10!=e.checkedPay[0]?e.pay_type=e.checkedPay[0]||e.checkedPay[1]||20:e.pay_type=e.checkedPay[1]||e.checkedPay[0],s()}))},switch2Change(e){this.balanceType=e.detail.value},submit(){let e=this;e.loading=!0,c({title:"加载中"});let a="user.order/pay";20==e.order_type&&(a="supplier.index/pay"),40==e.order_type&&(a="balance.plan/pay"),30==e.order_type&&(a="plus.live.plan/pay"),50==e.order_type&&(a="plus.advance.Order/pay");let t=1==e.balanceType?1:0;0==e.payPrice&&(t=1);let o={order_id:e.order_id,pay_source:e.getPlatform(),payType:e.pay_type,use_balance:t};e._post(a,o,(function(a){e.loading=!1,e.isPay=!0,s(),k(a,e,e.paySuccess,e.payError)}))},paySuccess(e){let a=this;return a.isPay=!0,console.log(a.order_type),30==a.order_type||40==a.order_type?void a.showSuccess("支付成功",(function(){console.log("back"),history.go(-1)})):20==a.order_type?void a.showSuccess("支付成功",(function(){a.gotoPage("/pages/user/my_shop/my_shop","reLaunch")})):50==a.order_type?void a.showSuccess("支付成功",(function(){a.gotoPage("/pages/order/myorder","reLaunch")})):void a.gotoPage("/pages/order/pay-success/pay-success?order_id="+e.data.order_id,"reLaunch")},payError(e){let a=this;a.isPay=!0,30==a.order_type||40==a.order_type?history.go(-1):20==a.order_type?a.gotoPage("/pages/user/my_shop/my_shop","redirect"):(a.order_type,a.gotoPage("/pages/order/myorder","redirect"))},payTypeFunc(e){this.pay_type=e}}},[["render",function(e,a,t,c,s,k){const P=i,x=f,v=m,T=g;return o(),r(P,{"data-theme":e.theme(),class:l(e.theme()||"")},{default:d((()=>[n(P,{class:"tc buy-checkout-top"},{default:d((()=>[n(P,{class:"f32 mb20"},{default:d((()=>[p("待支付")])),_:1}),n(P,{class:"redA8 f60 fb"},{default:d((()=>[p("￥"+y(s.payPrice||"0.00"),1)])),_:1})])),_:1}),n(P,{class:"buy-checkout p-0-30"},{default:d((()=>[(o(!0),u(h,null,_(s.checkedPay,((e,t)=>(o(),r(P,{key:t},{default:d((()=>[20==e?(o(),r(P,{key:0,class:l(20==s.pay_type?"item active":"item"),onClick:a[0]||(a[0]=e=>k.payTypeFunc(20))},{default:d((()=>[n(P,{class:"d-s-c"},{default:d((()=>[n(P,{class:"icon-box d-c-c mr10"},{default:d((()=>[n(x,{class:"icon iconfont icon-weixin"})])),_:1}),n(x,{class:"key"},{default:d((()=>[p("微信支付：")])),_:1})])),_:1}),n(P,{class:"icon-box d-c-c"},{default:d((()=>[n(x,{class:"icon iconfont icon-xuanze"})])),_:1})])),_:1},8,["class"])):b("",!0),30==e?(o(),r(P,{key:1,class:l(30==s.pay_type?"item active":"item"),onClick:a[1]||(a[1]=e=>k.payTypeFunc(30))},{default:d((()=>[n(P,{class:"d-s-c"},{default:d((()=>[n(P,{class:"icon-box d-c-c mr10"},{default:d((()=>[n(x,{class:"icon iconfont icon-zhifubao"})])),_:1}),n(x,{class:"key"},{default:d((()=>[p("支付宝支付：")])),_:1})])),_:1}),n(P,{class:"icon-box d-c-c"},{default:d((()=>[n(x,{class:"icon iconfont icon-xuanze"})])),_:1})])),_:1},8,["class"])):b("",!0)])),_:2},1024)))),128)),n(P,{class:"item"},{default:d((()=>[n(P,{class:"d-s-c"},{default:d((()=>[n(P,{class:"icon-box d-c-c mr10"},{default:d((()=>[n(x,{class:"icon iconfont icon-yue"})])),_:1}),n(x,{class:"key"},{default:d((()=>[p("余额抵扣：(剩余："+y(s.balance)+")",1)])),_:1})])),_:1}),n(v,{color:k.getTheme(),style:{transform:"scale(0.7)","margin-right":"-20rpx"},checked:s.balanceType,onChange:k.switch2Change},null,8,["color","checked","onChange"])])),_:1})])),_:1}),n(P,{class:"bottom-btn",onClick:k.submit},{default:d((()=>[n(T,{type:"default"},{default:d((()=>[p("立即支付")])),_:1})])),_:1},8,["onClick"])])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-6500513e"]]);export{P as default};
