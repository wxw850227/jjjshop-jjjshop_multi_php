import{_ as e,J as t,K as s,o as a,c as o,w as l,n as r,h as i,d as c,e as _,u as d,g as h,r as n,F as p,k as u,I as g,l as f,S as m,t as y,f as b,i as x}from"./index-73db7405.js";import{u as D}from"./uni-load-more.e615c410.js";const k=e({components:{uniLoadMore:D},data:()=>({triggered:!0,phoneHeight:0,scrollviewHigh:0,state_active:-1,no_more:!1,loading:!0,last_page:0,page:1,list_rows:10,topRefresh:!1,type_active:"all",price_top:!1,shopData:[],searchtxt:"",keyWord:"",stateTab:!1}),computed:{loadingType(){return this.loading?1:0!=this.shopData.length&&this.no_more?2:0}},onShow(){this.getTabBarLinks()},mounted(){this.init(),this._freshing=!1,this.restoreData(),this.getData()},methods:{init(){let e=this;t({success(t){e.phoneHeight=t.windowHeight,s().in(e).select(".top-box").boundingClientRect((t=>{console.log(t);let s=e.phoneHeight-t.height;e.scrollviewHigh=s})).exec()}})},restoreData(){this.shopData=[],this.page=1,this.no_more=!1,this.loading=!0,this.category_id=0,this.searchtxt="",this.sortType="",this.sortPrice=0},tabTypeFunc(e){let t=this;t.shopData=[],t.page=1,t.no_more=!1,t.loading=!0,t.type_active=e,t.getData()},getData(){let e=this,t=e.page,s=e.list_rows;e.loading=!0,e._post("supplier.index/list",{page:t||1,list_rows:s,sortType:e.type_active,name:e.keyWord},(t=>{e.loading=!1,e.last_page=t.data.list.last_page,e.shopData=e.shopData.concat(t.data.list.data),t.data.list.last_page<=1?e.no_more=!0:e.no_more=!1}))},onRefresh(){this._freshing||(this._freshing=!0,this.restoreData(),this.getData(),setTimeout((()=>{this.triggered=!1,this._freshing=!1}),2e3))},onRestore(){this.triggered="restore"},search(){let e=this;e.keyWord=e.searchtxt,e.restoreData(),e.getData()},scrolltolowerFunc(){let e=this;e.no_more||(e.page++,e.page<=e.last_page?e.getData():e.no_more=!0)},goto_shop(e){this.gotoPage("/pages/shop/shop?shop_supplier_id="+e)},goto_product(e){this.gotoPage("/pages/product/detail/detail?product_id="+e)}}},[["render",function(e,t,s,D,k,w){const v=u,T=g,R=i,C=x,F=f("uni-load-more"),H=m,L=f("tabBar");return a(),o(R,{"data-theme":e.theme(),class:r(e.theme()||"")},{default:l((()=>[c(R,{class:"top-box"},{default:l((()=>[c(R,{class:"index-search-box index-search-box_re d-b-c",id:"searchBox"},{default:l((()=>[c(R,{class:"index-search index-search_re t-c flex-1"},{default:l((()=>[c(v,{class:"icon iconfont icon-sousuo"}),c(T,{type:"text",modelValue:k.searchtxt,"onUpdate:modelValue":t[0]||(t[0]=e=>k.searchtxt=e),class:"flex-1 ml10 f30 gray3","placeholder-class":"f24 gray6",placeholder:"搜索商户","confirm-type":"search",onConfirm:t[1]||(t[1]=e=>w.search())},null,8,["modelValue"])])),_:1})])),_:1}),c(R,{class:"inner-tab"},{default:l((()=>[c(R,{class:r("all"==k.type_active?"item active":"item"),onClick:t[2]||(t[2]=e=>w.tabTypeFunc("all"))},{default:l((()=>[c(R,{class:"box"},{default:l((()=>[_("综合")])),_:1})])),_:1},8,["class"]),c(R,{class:r("sales"==k.type_active?"item active":"item"),onClick:t[3]||(t[3]=e=>w.tabTypeFunc("sales"))},{default:l((()=>[c(R,{class:"box"},{default:l((()=>[_("销量")])),_:1})])),_:1},8,["class"]),c(R,{class:r("score"==k.type_active?"item active":"item"),onClick:t[4]||(t[4]=e=>w.tabTypeFunc("score"))},{default:l((()=>[c(R,{class:"box"},{default:l((()=>[c(v,null,{default:l((()=>[_("评分")])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})])),_:1}),c(R,{class:"prodcut-list-wrap"},{default:l((()=>[c(H,{"scroll-y":"true",class:"scroll-Y",style:d("height:"+k.scrollviewHigh+"px;"),"lower-threshold":"50","refresher-triggered":k.triggered,onScrolltolower:w.scrolltolowerFunc,"refresher-enabled":"true",onRefresherrefresh:w.onRefresh,onRefresherrestore:w.onRestore},{default:l((()=>[c(R,{class:"shop_list_body"},{default:l((()=>[(a(!0),h(p,null,n(k.shopData,((e,t)=>(a(),o(R,{class:"shop_list_body_item",key:t},{default:l((()=>[c(R,{class:"shop_list_body_item_shop",onClick:t=>w.goto_shop(e.shop_supplier_id)},{default:l((()=>[c(R,{class:"shop_list_body_item_shop_logo"},{default:l((()=>[c(C,{src:e.logos},null,8,["src"])])),_:2},1024),c(R,{class:"shop_list_body_item_shop_info"},{default:l((()=>[c(R,{class:"h1 title"},{default:l((()=>[_(y(e.name),1)])),_:2},1024),c(R,{class:"h3 brand"},{default:l((()=>[_("主营品牌："+y(e.category_name),1)])),_:2},1024),c(R,{class:"h3 sales"},{default:l((()=>[_(" 销量"+y(e.product_sales)+"件 ",1),c(v,{class:"ml10 mr10"},{default:l((()=>[_("|")])),_:1}),_(" "+y(e.fav_count)+"人关注 ",1)])),_:2},1024)])),_:2},1024),c(R,{class:"shop_list_body_item_shop_others"},{default:l((()=>[c(R,{class:"f26 gray3 collect"},{default:l((()=>[_("商户评分")])),_:1}),c(R,null,{default:l((()=>[c(v,{class:"redEe f32 fb"},{default:l((()=>[_(y(e.server_score),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),e.productList.length>0?(a(),o(R,{key:0,class:r(e.productList.length<3?"shop_list_body_item_product2":"shop_list_body_item_product")},{default:l((()=>[(a(!0),h(p,null,n(e.productList,((e,t)=>(a(),o(R,{class:"shop_list_body_item_product_item",key:t,onClick:t=>w.goto_product(e.product_id)},{default:l((()=>[c(R,null,{default:l((()=>[c(C,{src:e.image[0].file_path},null,8,["src"])])),_:2},1024),c(R,{class:"shop_list_body_item_product_item_price"},{default:l((()=>[c(R,{class:"f22 red"},{default:l((()=>[_(" ¥ "),c(v,{class:"f32"},{default:l((()=>[_(y(e.product_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1032,["class"])):b("",!0)])),_:2},1024)))),128))])),_:1}),0!=k.shopData.length||k.loading?(a(),o(F,{key:1,loadingType:w.loadingType},null,8,["loadingType"])):(a(),o(R,{key:0,class:"d-c-c p30"},{default:l((()=>[c(v,{class:"iconfont icon-wushuju"}),c(v,{class:"cont"},{default:l((()=>[_("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:1},8,["style","refresher-triggered","onScrolltolower","onRefresherrefresh","onRefresherrestore"])])),_:1}),c(L)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-bdb97990"]]);export{k as default};
