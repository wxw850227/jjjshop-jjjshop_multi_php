import{_ as t,s as e,a,o as s,c as o,w as l,b as i,v as c,d as r,n,e as d,t as u,f as p,g as h,r as g,F as _,i as f,h as m,j as y,k as x,l as k,m as C,p as b,q as w,u as S,x as A,I as P,y as B,z as T,A as I,B as F,C as H,D as j,E as v,G as L,H as D}from"./index-73db7405.js";import{_ as R,a as M}from"./diy.e344ffa5.js";import{r as E}from"./uni-app.es.55ebdd9f.js";import{P as N}from"./uni-popup.a3ada4d4.js";import{u as V}from"./uni-load-more.e615c410.js";const U=t({components:{diy:R,Homepush:t({components:{Popup:N},data:()=>({isPopup:!1,type:0,width:600,height:800,backgroundColor:"none",boxShadow:"none",form:{},coupon:[]}),props:["homepush_data"],created(){},mounted(){this.setData()},methods:{setData(){this.isPopup=!0,this.form=this.homepush_data,this.type=this.homepush_data.type,this.coupon=this.homepush_data.coupon},hidePopupFunc(t){e("homepush_name",this.homepush_data.name),this.isPopup=!1},jumpPage(t){this.hidePopupFunc(),this.gotoPage("/"+t)},getCoupon(){let t=this,e=[];t.coupon.forEach((t=>{e.push(t.coupon_id)})),t._get("user.coupon/receiveList",{coupon_ids:JSON.stringify(e)},(function(e){a({title:"领取成功",icon:"success",mask:!0,duration:2e3}),t.hidePopupFunc()}))}}},[["render",function(t,e,a,C,b,w){const S=f,A=m,P=y,B=x,T=k("Popup");return s(),o(A,{class:"home-push-wrap"},{default:l((()=>[i(r(T,{width:b.width,height:b.height,backgroundColor:b.backgroundColor,boxShadow:b.boxShadow,padding:0,onHidePopup:w.hidePopupFunc},{default:l((()=>[r(A,{class:n(["home-push",1==b.type||3==b.type?"home-push-bg":""])},{default:l((()=>[1==b.type?(s(),o(A,{key:0,class:"image-text"},{default:l((()=>[r(A,{class:"pic"},{default:l((()=>[r(S,{src:b.form.file_path,mode:"aspectFill"},null,8,["src"])])),_:1}),r(A,{class:"title"},{default:l((()=>[d(u(b.form.title),1)])),_:1}),r(A,{class:"des"},{default:l((()=>[d(u(b.form.remark),1)])),_:1}),r(A,{class:"btns"},{default:l((()=>[r(P,{type:"primary",onClick:e[0]||(e[0]=t=>w.jumpPage(b.form.link.url))},{default:l((()=>[d(u(b.form.des),1)])),_:1})])),_:1})])),_:1})):p("",!0),2==b.type?(s(),o(A,{key:1,class:"image-only",onClick:e[1]||(e[1]=t=>w.jumpPage(b.form.link.url))},{default:l((()=>[r(A,{class:"pic"},{default:l((()=>[r(S,{src:b.form.file_path,mode:"aspectFill"},null,8,["src"])])),_:1})])),_:1})):p("",!0),3==b.type?(s(),o(A,{key:2,class:"cuopon"},{default:l((()=>[null!=b.form.file_path&&""!=b.form.file_path?(s(),o(A,{key:0,class:"cuopon-title d-c-c"},{default:l((()=>[r(S,{src:b.form.file_path,mode:"aspectFill"},null,8,["src"])])),_:1})):p("",!0),r(A,{class:"list"},{default:l((()=>[(s(!0),h(_,null,g(b.coupon,((t,e)=>(s(),o(A,{class:"item",key:e},{default:l((()=>[r(A,{class:"info"},{default:l((()=>[r(A,{class:"num"},{default:l((()=>[r(B,{class:"f30"},{default:l((()=>[d(u(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),r(A,{class:"explan"},{default:l((()=>[r(B,{class:"name"},{default:l((()=>[d(u(t.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),r(A,{class:"btns"},{default:l((()=>[r(P,{type:"primary",onClick:e[2]||(e[2]=t=>w.getCoupon())},{default:l((()=>[d("立即领取")])),_:1})])),_:1})])),_:1})):p("",!0)])),_:1},8,["class"]),r(A,{class:"close-btns",onClick:e[3]||(e[3]=t=>w.hidePopupFunc(!0))},{default:l((()=>[r(B,{class:"icon iconfont icon-guanbi"})])),_:1})])),_:1},8,["width","height","backgroundColor","boxShadow","onHidePopup"]),[[c,b.isPopup]])])),_:1})}],["__scopeId","data-v-73371435"]]),navBar:M,uniLoadMore:V,searchProduct:t({data:()=>({form:{},arr:[]}),mounted(){this.getData()},props:["isShow"],methods:{getData(){let t=this;C({key:"search_list",success:function(e){null!=e&&null!=e.data&&(t.arr=e.data)}})},stopTouchMove:()=>!0,search(t){let e=null;if(null!=t)e=t;else{e=this.form.keyWord;let t=this.arr;if(void 0===e||null==e||""==e)return a({title:"请输入搜索的关键字",icon:"none",duration:2e3}),!1;t.push(e),b({key:"search_list",data:t,success:function(){console.log("success")}})}this.gotoPage("/pages/product/list/list?search="+e+"&category_id=0&sortType=all")},clearStorage(){let t=this;w({key:"search_list",success:function(e){t.arr=[]}})},closeSearch(){this.$emit("close")}}},[["render",function(t,e,a,i,c,n){const f=m,y=x,k=P;return a.isShow?(s(),o(f,{key:0,onTouchmove:A(n.stopTouchMove,["stop","prevent"])},{default:l((()=>[r(f,{class:"search-wrap"},{default:l((()=>[r(f,{class:"state_top"}),r(f,{class:"head_top",style:S("height:"+t.topBarTop()+"px;")},null,8,["style"]),r(f,{class:"index-search-box d-b-c",id:"searchBox",style:S(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;padding-right: 200rpx")},{default:l((()=>[r(f,{class:"reg180",style:S(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;")},{default:l((()=>[r(y,{onClick:n.closeSearch,class:"icon iconfont icon-jiantou"},null,8,["onClick"])])),_:1},8,["style"]),r(f,{class:"index-search t-c flex-1",style:S(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;")},{default:l((()=>[r(y,{class:"icon iconfont icon-sousuo"}),r(k,{type:"text",modelValue:c.form.keyWord,"onUpdate:modelValue":e[0]||(e[0]=t=>c.form.keyWord=t),class:"flex-1 ml10 f30 gray3","placeholder-class":"f24 gray6",placeholder:"输入你要的商品","confirm-type":"search",onConfirm:e[1]||(e[1]=t=>n.search())},null,8,["modelValue"])])),_:1},8,["style"])])),_:1},8,["style"]),r(f,{class:"p-0-20 bg-white"},{default:l((()=>[r(f,{class:"group-hd"},{default:l((()=>[r(f,{class:"left"},{default:l((()=>[r(y,{class:"min-name"},{default:l((()=>[d("最近搜索")])),_:1})])),_:1}),r(f,{class:"right"},{default:l((()=>[r(y,{class:"icon iconfont icon-lajitong",onClick:n.clearStorage},null,8,["onClick"])])),_:1})])),_:1}),r(f,{class:"before-search"},{default:l((()=>[(s(!0),h(_,null,g(c.arr,((t,e)=>(s(),o(y,{class:"item",key:e,onClick:t=>n.search(c.arr[e])},{default:l((()=>[d(u(c.arr[e]),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["onTouchmove"])):p("",!0)}],["__scopeId","data-v-dd33c51e"]])},data:()=>({loading:!1,background:"",listData:[],indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,items:[],is_collection:!1,is_follow:"0",is_homepush:!1,homepush_data:{},triggered:!0,target:0,thisindex:0,category_list:[],product_list:[],page:1,last_page:0,no_more:!1,indexStop:0,title_name:"",bgcolor:"",msgNum:0,title_image:!1,toplogo:"",url:"",jweixin:null,showSearch:!1,openCategory:{color:"#000000",open:0},is_auto:0,searchStyle:{},searchIconTxt:""}),watch:{thisindex:function(t,e){t!=e&&(this.category_id=this.category_list[t].category_id,this.toggleInit(),0!=t&&this.getProduct())},bgcolor:function(){const t=this.bgcolor||"#ffffff",e=["#ffffff","#FFFFFF"].includes(t);this.$nextTick((()=>{this.searchStyle={color:e?"#ccc":t,borderColor:e?"#ccc":t},this.topBarHeight()&&this.topBarHeight()>0&&(this.searchStyle.height=`${this.topBarHeight()}px`),this.searchIconTxt={color:e?"#ccc":t},this.rightSearch={borderColor:e?"#ccc":t}}))}},computed:{loadingType(){return this.loading?1:0!=this.product_list.length&&this.no_more?2:0}},onTabItemTap(){window.location.href=B.app_url+B.h5_addr+"/pages/index/index"},onShow(){this.getTabBarLinks()},onLoad(){this.isWeixin()&&(this.url=window.location.href),console.log("topBarHeight1111111111",this.topBarHeight()),this._freshing=!1,this.getData(),this.getList()},onPullDownRefresh(){0==this.thisindex?this.getData():(this.toggleInit(),this.getProduct())},onReachBottom(){this.scrolltolowerFunc(),console.log("到底了")},methods:{getData(){let t=this;T({title:"加载中"}),t._get("index/index",{url:t.url},(function(e){let a=I("TabBar").is_auto&&0!=I("TabBar").is_auto;t.is_auto=a,t.listData=e.data.list,t.background=e.data.background,t.items=e.data.items,t.title_name=e.data.page.params.title,t.bgcolor=e.data.page.style.titleBackgroundColor,t.msgNum=e.data.msgNum,t.toplogo=e.data.page.style.toplogo,t.setPage(e.data.page),t.title_type=e.data.page.params.title_type,t.titleTextColor=e.data.page.style.titleTextColor,t.openCategory=e.data.page.category;let s=I("homepush_name");e.data.setting.homepush.is_open&&s!=e.data.setting.homepush.name&&(t.homepush_data=e.data.setting.homepush,t.is_homepush=!0,t.is_homepush=!0),""!=t.url&&(t.jweixin=t.configWxScan(e.data.signPackage)),F(),t.loadding=!1,H()}))},getList(){let t=this;t._get("product.category/index",{},(function(e){t.category_list=e.data.list;t.category_list.unshift({name:"推荐",category_id:"0"})}))},getProduct(){let t=this,e=t.page;t.loading=!0,t._get("product.product/lists",{page:e||1,category_id:t.category_id,search:"",sortType:"all",sortPrice:0,list_rows:10},(function(e){t.loading=!1,H(),t.product_list=t.product_list.concat(e.data.list.data),t.last_page=e.data.list.last_page,e.data.list.last_page<=1&&(t.no_more=!0)}))},scrolltolowerFunc(){let t=this;t.page<t.last_page&&(t.page++,t.getProduct()),t.no_more=!0},setPage(t){j({title:t.params.name});let e="#000000";"white"==t.style.titleTextColor&&(e="#ffffff"),v({frontColor:e,backgroundColor:t.style.titleBackgroundColor})},onShareAppMessage(){return{title:this.page.params.share_title,path:"/pages/index/index?"+this.getShareUrlParams()}},setTabBarItem(t){2==t&&(console.log("订单"),L({index:2,pagePath:"/pages/order/myorder",text:"订单",iconPath:"static/order.png",selectedIconPath:"static/order_active.png"}))},toggleInit(){this.page=1,this.last_page=0,this.no_more=!1,this.product_list=[]},setIndex(t){this.thisindex=t},stopTouchMove:()=>!0,scanQrcode:function(){let t=this;t.jweixin.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){t.gotoPage("/pages/store/clerkorder?order_no="+e.resultStr)},error:function(t){a({title:"扫码失败，请重试"})}})},closeSearch(){this.showSearch=!1}}},[["render",function(t,e,a,i,c,C){const b=m,w=f,A=x,P=E(D("navBar"),M),B=E(D("diy"),R),T=k("uni-load-more"),I=y,F=k("Homepush"),H=k("searchProduct"),j=k("tabBar");return s(),o(b,{"data-theme":t.theme(),class:n(t.theme()||"")},{default:l((()=>[r(b,{class:"top_head pr",style:S("background-color: "+c.bgcolor+";")},{default:l((()=>[r(b,{class:"state_top"}),r(b,{class:"head_top",style:S("height:"+t.topBarTop()+"px;")},null,8,["style"]),r(b,{class:"d-b-c",style:S(0==t.topBarHeight()?"":"height:"+t.topBarHeight()+"px;")},{default:l((()=>[r(b,{class:"index_log"},{default:l((()=>[r(w,{src:c.toplogo||"",mode:""},null,8,["src"])])),_:1}),r(b,{class:"d-s-c flex-1"},{default:l((()=>[r(b,{class:"top_search special",style:S(c.searchStyle),onClick:e[0]||(e[0]=t=>c.showSearch=!0)},{default:l((()=>[r(A,{class:"icon iconfont icon-sousuo",style:S(c.searchIconTxt)},null,8,["style"]),d("搜索商品 ")])),_:1},8,["style"]),r(b,{class:"top_search_right",onClick:C.scanQrcode,style:S(t.rightSearch)},{default:l((()=>[r(A,{class:"icon iconfont icon-saoyisao1"})])),_:1},8,["onClick","style"])])),_:1}),r(b,{class:"d-e-c p-0-20"},{default:l((()=>[r(b,{class:"news pr",onClick:e[1]||(e[1]=e=>t.gotoPage("/pagesPlus/chat/chat_list"))},{default:l((()=>[r(w,{class:"chat",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAdVBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////li2ZAAAAAJnRSTlMA4vtEmffelL7u8RqNLwjPyTi3a1McESLmxIiFSNiwrXApJAeeZWdy/HEAAAFvSURBVDjLnZXZmoMgDIVBp3Wp1L3uXezU93/EIdExuCDzzbmK8ANJIJEtdMscl/uDz10nuzGt7PtpIJ3u9j4WR8NaUbzFro41zVoe98BGOdcVl4cjlKTiLT/fIk1GOMwX3IujV8GFkS4Besxf6n7IuT1bqnCRzMk/PLdhWzV4+uynA59PtqcnRvSbF3C7ZvuqIcQpSxH4x3QCPyO0Woi314IFxN6C9ZBGwPQK5PwD3oFcYV0wcc3XUvU4bMkT5QvJ5IKEgaphrQrHE2llY25SHPA3oI/jKWYIoxKzM4pm18WYFS5dnFIv7KXEdHHSyTMe6LNjeYjAtRtALpk/gb55R/LRCFLUBNqhh6oEQZRHBSzpQkh0MwR6c5USRHetgC0fuS7eeT3mYHp8jwQaXrgBpJoxgVSFCJYMZahrqFXqJAedopP2N03qe08wAKnuqelmBa6zyrOi/f74GUjHHfejdO7jHl44nbUs0xL/Cv/TD1fkRxhCbcVeAAAAAElFTkSuQmCC",mode:""}),c.msgNum?(s(),o(b,{key:0,class:"newsnum"},{default:l((()=>[d(u(c.msgNum),1)])),_:1})):p("",!0)])),_:1})])),_:1})])),_:1},8,["style"]),c.openCategory.open?(s(),o(b,{key:0,class:"nuter"},{default:l((()=>[r(P,{style:{width:"100%"},color:c.openCategory.color,onCurrentIndex:C.setIndex,currentI:c.thisindex,navList:c.category_list},null,8,["color","onCurrentIndex","currentI","navList"])])),_:1})):(s(),o(b,{key:1,style:{height:"20rpx"}}))])),_:1},8,["style"]),r(b,{class:"top_bg",style:S("background-color: "+c.bgcolor+";")},null,8,["style"]),r(b,null,{default:l((()=>[0==c.thisindex?(s(),o(b,{key:0},{default:l((()=>[r(B,{style:{position:"relative"},diyItems:c.items},null,8,["diyItems"])])),_:1})):p("",!0),0!=c.thisindex?(s(),o(b,{key:1},{default:l((()=>[r(b,{class:"product-list"},{default:l((()=>[(s(!0),h(_,null,g(c.product_list,((e,a)=>(s(),o(b,{key:a,class:n(["product_item o-h",a%2==1?"product_item_right":""]),onClick:a=>t.gotoPage("/pages/product/detail/detail?product_id="+e.product_id)},{default:l((()=>[r(b,null,{default:l((()=>[r(w,{src:e.product_image,mode:"",style:{width:"345rpx",height:"345rpx"}},null,8,["src"])])),_:2},1024),r(b,{class:"text-ellipsis-2 f26 pro_name p-0-20 mt20"},{default:l((()=>[d(u(e.product_name),1)])),_:2},1024),r(b,{class:"mt36 mb20 p-0-20"},{default:l((()=>[r(A,{class:"f20 fb redF6"},{default:l((()=>[d("￥")])),_:1}),r(A,{class:"f32 fb redF6"},{default:l((()=>[d(u(e.product_sku.product_price),1)])),_:2},1024),r(A,{class:"text-d-line f20 gray9 ml10"},{default:l((()=>[d("￥")])),_:1}),r(A,{class:"text-d-line f24 gray9"},{default:l((()=>[d(u(e.product_sku.line_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),0!=c.product_list.length||c.loading?(s(),o(T,{key:1,loadingType:C.loadingType},null,8,["loadingType"])):(s(),o(b,{key:0,class:"d-c-c p30 ww100"},{default:l((()=>[r(A,{class:"iconfont icon-wushuju"}),r(A,{class:"cont"},{default:l((()=>[d("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:1})):p("",!0)])),_:1}),c.is_collection?(s(),o(b,{key:0,class:"collection-box",style:S("top:"+(t.topBarTop()+t.topBarHeight()+10)+"px;")},{default:l((()=>[r(b,{class:"inner"},{default:l((()=>[r(A,null,{default:l((()=>[d(" 点击“")])),_:1}),r(A,{class:"point"},{default:l((()=>[d(".")])),_:1}),r(A,{class:"point point-big"},{default:l((()=>[d(".")])),_:1}),r(A,{class:"point"},{default:l((()=>[d(".")])),_:1}),r(A,null,{default:l((()=>[d("”添加到我的小程序，\\n微信首页下拉即可快速访问店铺 ")])),_:1})])),_:1}),r(I,{type:"primary",class:"close-btn",onClick:e[2]||(e[2]=t=>c.is_collection=!1)},{default:l((()=>[d("x")])),_:1})])),_:1},8,["style"])):p("",!0),c.is_homepush?(s(),o(F,{key:1,homepush_data:c.homepush_data},null,8,["homepush_data"])):p("",!0),r(H,{isShow:c.showSearch,onClose:C.closeSearch},null,8,["isShow","onClose"]),r(j)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-e0bc086f"]]);export{U as default};
