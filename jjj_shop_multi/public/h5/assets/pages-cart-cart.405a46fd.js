import{_ as e,J as t,A as a,s as c,a as l,z as s,B as d,N as o,o as i,c as m,w as n,n as r,h,d as u,g as Z,e as p,F as k,r as f,t as g,f as A,j as _,O as C,P as b,Q as D,k as E,i as w,H as v,l as P,R as V,x as y}from"./index-73db7405.js";import{_ as B}from"./recommendProduct.4b8a4520.js";import{r as F}from"./uni-app.es.55ebdd9f.js";const I=e({components:{recommendProduct:B},data:()=>({isloadding:!0,scrollviewHigh:0,loadding:!0,isEdit:!1,tableData:[],arrIds:[],checkedAll:!1,totalPrice:0,totalProduct:0,store_open:1,is_auto:0}),onLoad(){},onShow(){this.getData(),this.getTabBarLinks()},mounted(){this.init()},methods:{init(){let e=this;t({success(t){let a=t.windowWidth/750,c=t.windowHeight-98*a;e.scrollviewHigh=c}})},getData(){let e=this;e.isloadding=!0,e._get("order.cart/lists",{},(function(t){let c=a("TabBar").is_auto&&0!=a("TabBar").is_auto;e.is_auto=c,e.isloadding=!1,e.tableData=t.data.productList,e.tableData.forEach(((e,t)=>{e.checked=!1})),e.loadding=!1,e._initGoodsChecked()}))},_initGoodsChecked(){let e=this,t=e.getCheckedData(),a=0;e.tableData.forEach((c=>{c.productList.forEach((c=>{a++,c.checked=e.inArray(`${c.cart_id}`,t)}))})),e.totalProduct=a,e.isEdit=!1,e.checkedAll=t.length==e.totalProduct,e.tableData.forEach(((e,t)=>{this.onUpsupChecked(this.tableData,t)})),e.updateTotalPrice()},getCheckedData(){let e=a("CheckedData");return e||[]},checkItem(e,t,a){e.checked=!e.checked,this.$set(this.tableData[t].productList,a,e),console.log(this.tableData),this.onUpsupChecked(this.tableData,t),this.onUpdateChecked(),this.updateTotalPrice(),console.log(this.getCheckedData().length),this.checkedAll=this.getCheckedData().length==this.totalProduct},onUpsupChecked(e,t){let a=!0;for(var c=0;c<e[t].productList.length;c++)e[t].productList[c].checked||(a=!1);this.$set(e[t],"checked",a),console.log("item====="+a)},onUpdateChecked(){let e=[];this.tableData.forEach((t=>{t.productList.forEach((t=>{1==t.checked&&e.push(`${t.cart_id}`)}))})),console.log(e),c("CheckedData",e)},checkStprItem(e,t){console.log(e),e.checked=!e.checked,e.productList.forEach(((t,a)=>{t.checked=e.checked})),this.updateTotalPrice(),this.onUpdateChecked(),console.log(this.getCheckedData().length),this.checkedAll=this.getCheckedData().length==this.totalProduct},onCheckedAll(){console.log("111111111");let e=this;e.checkedAll=!e.checkedAll,e.tableData.forEach((t=>{this.$set(t,"checked",e.checkedAll),t.productList.forEach((t=>{t.checked=e.checkedAll}))})),e.updateTotalPrice(),e.onUpdateChecked()},updateTotalPrice:function(){let e=0,t=this.tableData;for(let a=0;a<t.length;a++)for(let c=0;c<t[a].productList.length;c++)1==t[a].productList[c].checked&&(e+=t[a].productList[c].total_num*t[a].productList[c].product_price);this.totalPrice=e.toFixed(2)},Submit(){let e=this.getCheckedIds();if(0==e.length)return l({title:"请选择商品",icon:"none"}),!1;this.gotoPage("/pages/order/confirm-order?order_type=cart&cart_ids="+e)},addFunc(e){let t=this,a=e.product_id,c=e.spec_sku_id;s({title:"加载中"}),t._post("order.cart/add",{product_id:a,spec_sku_id:c,total_num:1},(function(e){d(),t.loadding=!1,t.getData()}),(function(){t.loadding=!1}))},reduceFunc(e){let t=this,a=e.product_id,c=e.spec_sku_id;e.total_num<=1||(s({title:"加载中"}),t._post("order.cart/sub",{product_id:a,spec_sku_id:c},(function(e){t.loadding=!1,d(),t.getData()}),(function(){t.loadding=!1})))},onDelete(){let e=this,t=e.getCheckedIds();if(!t.length)return e.showError("您还没有选择商品"),!1;o({title:"提示",content:"您确定要移除选择的商品吗?",success(a){a.confirm&&e._post("order.cart/delete",{cart_id:t},(function(a){e.getData(),e.onDeleteEvent(t)}))}})},getCheckedIds(){let e=[];return this.tableData.forEach((t=>{t.productList.forEach((t=>{1==t.checked&&e.push(`${t.cart_id}`)}))})),e},onDeleteEvent(e){let t=this;return e.forEach((e=>{t.tableData.forEach(((a,c)=>{e==`${a.cart_id}`&&t.tableData.splice(c,1)}))})),t.$nextTick((()=>{t.onUpdateChecked()})),!0},inArray(e,t){for(var a in t)if(t[a]==e)return!0;return!1},gotoShop(){this.gotoPage("/pages/index/index")}}},[["render",function(e,t,a,c,l,s){const d=_,o=h,I=C,L=b,x=D,G=E,R=w,W=F(v("recommendProduct"),B),q=P("request-loading"),O=P("tabBar");return i(),m(o,{"data-theme":e.theme(),class:r(e.theme()||"")},{default:n((()=>[l.loadding?A("",!0):(i(),m(o,{key:0,class:"card"},{default:n((()=>[u(o,{class:r({pb100:l.tableData.length>0}),style:{position:"relative"}},{default:n((()=>[l.tableData.length>0?(i(),Z(k,{key:0},[u(o,{class:"address-bar d-e-c"},{default:n((()=>[u(o,{class:"f30",onClick:t[0]||(t[0]=e=>l.isEdit=!l.isEdit)},{default:n((()=>[l.isEdit?(i(),m(d,{key:0,class:"f24"},{default:n((()=>[p("完成")])),_:1})):(i(),m(d,{key:1,class:"f24"},{default:n((()=>[p("编辑")])),_:1}))])),_:1})])),_:1}),u(o,{class:"section"},{default:n((()=>[(i(!0),Z(k,null,f(l.tableData,((t,a)=>(i(),m(o,{key:a},{default:n((()=>[u(o,{class:"supplier_list"},{default:n((()=>[u(o,{class:"supplier_list_tit"},{default:n((()=>[u(x,{onChange:e=>s.checkStprItem(t,a)},{default:n((()=>[u(L,{class:"d-c-c"},{default:n((()=>[u(I,{color:"red",value:"cb",class:"checkbox",checked:t.checked},null,8,["checked"])])),_:2},1024)])),_:2},1032,["onChange"]),u(o,{class:"d-a-c",onClick:a=>e.gotoPage("/pages/shop/shop?shop_supplier_id="+t.supplier.shop_supplier_id)},{default:n((()=>[V("i",{class:"icon iconfont icon-dianpu1"}),u(G,{class:"f32 gray3"},{default:n((()=>[p(g(t.supplier.name),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024),(i(!0),Z(k,null,f(t.productList,((t,c)=>(i(),m(o,{class:"item",key:c},{default:n((()=>[u(x,{onChange:e=>s.checkItem(t,a,c)},{default:n((()=>[u(L,{class:"d-c-c"},{default:n((()=>[u(I,{color:"red",value:"cb",class:"checkbox",checked:t.checked},null,8,["checked"])])),_:2},1024)])),_:2},1032,["onChange"]),u(o,{style:{overflow:"hidden"}},{default:n((()=>[u(R,{onClick:a=>e.gotoPage("/pages/product/detail/detail?product_id="+t.product_id),src:t.product_image,class:"cover",mode:"aspectFit"},null,8,["onClick","src"])])),_:2},1024),u(o,{class:"info"},{default:n((()=>[u(o,{class:"title"},{default:n((()=>[p(g(t.product_name),1)])),_:2},1024),u(o,{class:"describe"},{default:n((()=>[p(g(t.product_sku.product_attr),1)])),_:2},1024),u(o,{class:"level-box count_choose"},{default:n((()=>[u(o,{class:"price"},{default:n((()=>[p(" ¥ "),u(G,{class:"num"},{default:n((()=>[p(g(t.product_price),1)])),_:2},1024)])),_:2},1024),u(o,{class:"num-wrap"},{default:n((()=>[t.total_num>1?(i(),m(o,{key:0,class:"",onClick:y((e=>s.reduceFunc(t)),["stop"])},{default:n((()=>[u(R,{class:"reduce_icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAilBMVEUAAABmZmZmZmZmZmZlZWVpaWlmZmZmZmZoaGhmZmZnZ2dpaWlkZGRnZ2dmZmZmZmZmZmZmZmZmZmZmZmZlZWVmZmZmZmZmZmZmZmZmZmZmZmZnZ2dmZmZmZmZmZmZmZmZmZmZmZmZlZWVlZWVmZmZmZmZmZmZmZmZlZWVmZmZmZmZlZWVlZWVmZmaDiK+QAAAALXRSTlMA+VW9QwXv5BbUJgkPn8703kovHMTYt7ES6aY9h8iOmU99Wip1bZF/qzV4aGAFJZmLAAADDUlEQVRYw6VX6XqrIBBFFFwgGnfjviZq6vu/3h2bfm0ujY0J5ycwh5lhmAX9BmFG5w5lqtpHnQL0o62m5eB2BiNoB4jRZXiuIlt3li84uh1VM846YwcDs3A+BqZOleUOCtXNYMyxxZ6Ic8vt0/AmEdpFEKhqEBR2eOML0961+F/yidbE5mlV2oyr5trWrqa5dXttqthcDTqZcaMlf2l/tj+PqYfLh+b5jNyc6nvax+WgflLb5007yNTHR9D0mPb1ZPmc3G1x35rqPj2Cbce4nx4y8KwJFNiP8tZijxVs8+gIR4Im4w/ktdIGM80SewbZemAPn01wkF1q/IE8bJ3Ui7glHssLCtf8YmDZOVSWU3zt+JN39oaILkp4zv4zk3iX9f7xw0dPYV3jE+hw8cj94lwoC41bf0+o+20MOhSz9bOU4Ajko6uPdsH/WBkinJDv+DvDAxcDUO5kuKoQLufvmLSaQlHC3EO70V1MRSmarxuZGzvAB27dDZKBzk7sfooQqzcXRcUJegEJVpXF7C2yhhdO6SIY8BxeHi40xQaBCM9NhY7YeI3AwCNVzLxjyMhG56bMbnwb7oyZgTocgAdqhl4Eq8ELAe6QO4Mx1YRexlSB62YXDZWumPCiL8NqTEWvBlRGlEbCJ9oZ0KtkiVIbeDT+OgHXQHc7Raq+hOvXfBmQAsJFVxHkMXvw0RvwBxuyG4IsWbT8HQLeFpCDEWSXoCbvEJA6gCyGKBC46C24QEBXAvWOgCTWpG1ispI7ZTX1AQGfhlTdRDpMXCAQTUjqA102QQ91IpggOhEInG0CBwgEJ4rPyLO80DdR5BkXnlEMJOa15SE9PAIsl63HhEASQxkKqIs34ULhFUNZ/EyEJ8YmEk7EzyT9naUTinRKk0yqbSef1lknV1ikShtcS94urtGtuEqXd/kG46fFCd5ocaSbrHfbvPF0a/MkG00m2+puNNvZs2Y7uGu2RYYd7X651e4DQ3YpZAYOODDN+0aeeWKyQ5f02Ld/8FQB+wdP+dFXfvgWx/8TdRx6+nP8/wdWpoH8K7QZOAAAAABJRU5ErkJggg==",mode:""})])),_:2},1032,["onClick"])):A("",!0),u(o,{class:"text-wrap"},{default:n((()=>[p(g(t.total_num),1)])),_:2},1024),t.total_num<t.product_sku.stock_num?(i(),m(o,{key:1,class:"",onClick:y((e=>s.addFunc(t)),["stop"])},{default:n((()=>[u(R,{class:"add_icon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAjVBMVEUAAABpaWlnZ2dmZmZmZmZmZmZmZmZkZGRnZ2dmZmZlZWVmZmZmZmZpaWlmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZWVnZ2dmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZWVmZmZlZWVmZmZmZmZlZWVmZmZmZmYQR7WMAAAALnRSTlMABSb5WO++ERbSQXzVCY8NalLF9Lh2cM7YRSobMd5L4umx5aCrl6bJOGCCiR+blsmQzgAAA9xJREFUWMO1V+caqjAMLVCGlFlApgxlOnj/x7sBR70y1Ot3zy8pcpqk6UmCpuB0JUoto5b83V4E7He+VBtWGik6hz4Ap0Qq9irXz5z+Bifz3crDaqR8wKDz+FhSLROF/gmCmGm0PGJeR+sw+XRbB9cvAr+hEoA2fnDlC+ptystoBbJKik0+GK0VFbGwnYZhamOLVIU2OJRvChLKK9bbhj/+TbqQLoxic3SZM+Mo7MhFGql9w17yg0u8YgeW7mrPbvlY5p5eyTHf2l69A992hZfMMpgtoQK8d08QqoXwnlzYQaCkNefcNzbg5sbAicItHXCCDQ0CtDFUebK/OrzKpaP6JsonKva9Zqjmi3mtEQh9XliR+eacE8sVeyEwWv3v+JEN7F92Z/QWvFXk4CpJuOdFD+InFjj+JNXPuAAbGo9/OiTswveudUYf4dwNDC5+HLQcGnDAdAuUHzJYEqSL8chJnjSCEJwS9DGioyYIDbntqKeF02eGqn9OwKlG1jtFqo8PvKeNHqEvMEZN83huSC9cin1wimZ3MmXZnM3L5BT0YokVDjIc/Bl+zmVNlHZdOptbw7aCdox0pKilczVmihjXTVNPsuPhuFOqCoowhQjY+vyfApCheXLdhihQHKGUgDOXBM0T7OC85wlQcoHQkRRZVSZohJ8n2G4g67fzBDzRhKyykOGKotvF3xPE3fClgWofeEL5ewI5BNv9Gkl78CThvifgEojeXkK+0/tWjL4nQLG16R0fgUo22PwXAhM3oMEI1IXaCyqqWH4P9ikLN8qmoGIIJFJK0TziK8GSToWgCuJIED6XEL5Vbwi7akikqgvvKy0vc28IzHZbS3fQwIEqENDHQr1tzReCVxfk9CD2ixAP6VPGpAPBI4iMwFkmcIDgJYivx2iqR7ofke33uSgMnUI+PIygR9V8OcbXRDIjfDqMuBwOZSOCkU05PIw44cj864wc/5HKrICGGNsjsHXI+j47WPdnHELhfUlldpmYDCo3xC3RoJCSNr6vMIFkl2nlOqPzNZXPaOU6rwkKVKCBACreiqCsS9rVglVJY6L6FQETVSbr3xEwWdcjVlg+J2CFhZW2hV0WrIvupW2tuIIFAwFYsFxc18o7EFjUcag1JYDyvruVd9ZgHJNprtgVpZUdTx0grMFYa3HkBHseTuQJ8dDisAuw3GRBm83z8aRBiFmTxdq85ps2r8xZm/dDo6n/2ur+2mz/2u7/PnBMof8w8vw8dDGhfBn7QsDa2Ddl4FNvbfD0YPD8n6MvG74JDN97NnzvYfgma8P3dPzfjuN/LjqOmI/j/3Zh/P8DDsSbMWz1m30AAAAASUVORK5CYII=",mode:""})])),_:2},1032,["onClick"])):A("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})],64)):(i(),m(o,{key:1,class:"none-data-box cart_none"},{default:n((()=>[u(R,{class:"cart_none_img",src:"/h5/assets/cart_none-42f96ca4.png",mode:"widthFix"}),u(G,{class:"f26 gray9 pt10"},{default:n((()=>[p("购物车空空如也")])),_:1}),u(d,{type:"default",class:"theme-btn mt30 ww100 none_btn",onClick:s.gotoShop},{default:n((()=>[p("去购物")])),_:1},8,["onClick"])])),_:1})),l.tableData.length>0?(i(),m(o,{key:2,class:r(["bottom-btns f28",{is_auto:l.is_auto}])},{default:n((()=>[u(x,{onChange:s.onCheckedAll},{default:n((()=>[u(L,{class:"d-c-c mr20"},{default:n((()=>[u(I,{color:"red",class:"checkbox",checked:l.checkedAll,value:"cb"},null,8,["checked"]),p(" 全选 ")])),_:1})])),_:1},8,["onChange"]),l.isEdit?(i(),m(o,{key:1,class:"pr20"},{default:n((()=>[u(d,{type:"primary",onClick:t[2]||(t[2]=e=>s.onDelete()),class:"delete-btn theme-btn mr20"},{default:n((()=>[p("删除")])),_:1})])),_:1})):(i(),m(o,{key:0,class:"d-e-c pr20"},{default:n((()=>[u(o,{class:"total d-s-c flex-1 mr20"},{default:n((()=>[u(G,{class:"f24 gray9"},{default:n((()=>[p("合计：")])),_:1}),u(o,{class:"price f24"},{default:n((()=>[p(" ¥ "),u(G,{class:"num f32"},{default:n((()=>[p(g(l.totalPrice),1)])),_:1})])),_:1})])),_:1}),u(d,{type:"primary",class:"buy-btn theme-btn",onClick:t[1]||(t[1]=e=>s.Submit())},{default:n((()=>[p("去结算")])),_:1})])),_:1}))])),_:1},8,["class"])):A("",!0),u(W,{location:10})])),_:1},8,["class"])])),_:1})),u(q,{loadding:l.isloadding},null,8,["loadding"]),u(O)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-86059978"]]);export{I as default};
