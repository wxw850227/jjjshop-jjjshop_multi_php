import{_ as e,J as t,K as a,z as l,B as s,o,c,w as i,h as n,d as u,n as p,e as _,g as d,r,F as f,f as g,u as y,S as h,t as m,x as k,k as b}from"./index-73db7405.js";const x=e({data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:0,DataList:{},no_more:!1,loading:!1,data_type:"not_use",supList:[]}),mounted(){this.init(),this.getData()},methods:{init(){let e=this;t({success(t){e.phoneHeight=t.windowHeight,a().select(".top-tabbar").boundingClientRect((t=>{let a=e.phoneHeight-t.height;e.scrollviewHigh=a})).exec()}})},getData(){let e=this;l({title:"加载中"});let t=e.data_type;e._get("user.coupon/lists",{data_type:t},(function(t){s(),e.DataList=t.data.list,e.getSup()}))},getSup(){let e=[],t={name:"平台优惠券",list:[]};this.DataList.forEach(((a,l)=>{if(console.log(l),null==a.supplier)t.list.push(a);else if(""==e)e.push({name:a.supplier.name,list:[a]});else{let t=!0;e.forEach(((e,l)=>{e.name===a.supplier.name&&(t=!1,e.list.push(a))})),t&&e.push({name:a.supplier.name,list:[a]})}})),console.log(e),e.push(t),this.supList=e},stateFunc(e){let t=this;t.state_active!=e&&(0==e&&(t.data_type="not_use"),1==e&&(t.data_type="is_use"),2==e&&(t.data_type="is_expire"),t.state_active=e,t.getData())},scrolltoupperFunc(){console.log("滚动视图区域到顶")},scrolltolowerFunc(){console.log("滚动视图区域到底")},lookRule(e){e.rule=!0},closeRule(e){e.rule=!1}}},[["render",function(e,t,a,l,s,x){const v=n,C=b,w=h;return o(),c(v,null,{default:i((()=>[u(v,{class:"top-tabbar"},{default:i((()=>[u(v,{class:p(0==s.state_active?"tab-item active":"tab-item"),onClick:t[0]||(t[0]=e=>x.stateFunc(0))},{default:i((()=>[_("未使用")])),_:1},8,["class"]),u(v,{class:p(1==s.state_active?"tab-item active":"tab-item"),onClick:t[1]||(t[1]=e=>x.stateFunc(1))},{default:i((()=>[_("已使用")])),_:1},8,["class"]),u(v,{class:p(2==s.state_active?"tab-item active":"tab-item"),onClick:t[2]||(t[2]=e=>x.stateFunc(2))},{default:i((()=>[_("已过期")])),_:1},8,["class"])])),_:1}),u(w,{"scroll-y":"true",class:"scroll-Y",style:y("height:"+s.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltoupper:x.scrolltoupperFunc,onScrolltolower:x.scrolltolowerFunc},{default:i((()=>[u(v,{class:"p30 bg-white"},{default:i((()=>[s.supList.length>0?(o(!0),d(f,{key:0},r(s.supList,((a,l)=>(o(),c(v,{class:"item-wrap mb20",key:l},{default:i((()=>[s.supList[0].list.length>0?(o(),c(v,{key:0,class:"d-f"},{default:i((()=>[u(C,{class:"icon iconfont icon-dianpu1"}),u(v,{class:"con_tit"},{default:i((()=>[_(m(a.name),1)])),_:2},1024)])),_:2},1024)):g("",!0),a.list.length>0?(o(!0),d(f,{key:1},r(a.list,((l,s)=>(o(),c(v,{key:s,class:"coupon_item"},{default:i((()=>[u(v,{class:p(0==l.is_expire&&0==l.is_use?"coupon-item coupon-item-"+l.color.text:"coupon-item coupon-item-gray"),onClick:e=>x.lookRule(l)},{default:i((()=>[u(v,{class:"coupon_type"},{default:i((()=>[_(m("平台优惠券"==a.name?"平台通用":a.name),1)])),_:2},1024),u(v,{class:"circles"},{default:i((()=>[(o(),d(f,null,r(8,((e,t)=>u(C,{key:t}))),64))])),_:1}),u(v,{class:"info"},{default:i((()=>[u(v,null,{default:i((()=>[_(m(l.coupon_type.text),1)])),_:2},1024)])),_:2},1024),u(v,{class:"operation d-b-c"},{default:i((()=>[u(v,{class:"flex-1 coupon-content"},{default:i((()=>[u(v,null,{default:i((()=>[10==l.coupon_type.value?(o(),c(v,{key:0,class:"price"},{default:i((()=>[u(C,{class:"f40 fb"},{default:i((()=>[_("减"+m(1*l.reduce_price)+"元",1)])),_:2},1024)])),_:2},1024)):g("",!0),20==l.coupon_type.value?(o(),d(f,{key:1},[u(C,{class:"f40 fb"},{default:i((()=>[_(m(l.discount),1)])),_:2},1024),u(C,null,{default:i((()=>[_("折")])),_:1})],64)):g("",!0)])),_:2},1024),u(v,{class:"f30"},{default:i((()=>[_(m(l.min_price>0?"满"+1*l.min_price+"元可用":"无门槛"),1)])),_:2},1024),u(v,{class:"f24"},{default:i((()=>[_(" 有效期："+m(l.start_time.text)+"至"+m(l.end_time.text),1)])),_:2},1024)])),_:2},1024),u(v,{class:"right-box d-c-c"},{default:i((()=>[l.state.value>0?(o(),d(f,{key:0},[10!=l.apply_range?(o(),c(v,{key:0,type:"default",class:"f30",onClick:k((t=>e.gotoPage("/pages/coupon/detail?coupon_id="+l.coupon_id+"&apply_range="+l.apply_range)),["stop"])},{default:i((()=>[_(" 立即使用 ")])),_:2},1032,["onClick"])):0==l.shop_supplier_id?(o(),c(v,{key:1,type:"default",class:"f30",onClick:t[3]||(t[3]=k((t=>e.gotoPage("/pages/index/index")),["stop"]))},{default:i((()=>[_(" 立即使用 ")])),_:1})):(o(),c(v,{key:2,type:"default",class:"f30",onClick:k((t=>e.gotoPage("/pages/shop/shop?shop_supplier_id="+l.shop_supplier_id)),["stop"])},{default:i((()=>[_(" 立即使用 ")])),_:2},1032,["onClick"]))],64)):(o(),c(v,{key:1,class:"f30"},{default:i((()=>[u(C,null,{default:i((()=>[_(m(l.state.text),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"]),20==l.apply_range?(o(),c(v,{key:0,class:"range_item d-b-c",onClick:k((t=>e.gotoPage("/pages/coupon/detail?coupon_id="+l.coupon_id+"&apply_range="+l.apply_range)),["stop"])},{default:i((()=>[u(v,null,{default:i((()=>[_("仅可购买指定部分商品")])),_:1}),u(v,null,{default:i((()=>[u(C,{class:"icon iconfont icon-jiantou",style:{color:"#999999","font-size":"24rpx"}})])),_:1})])),_:2},1032,["onClick"])):g("",!0),30==l.apply_range?(o(),c(v,{key:1,class:"range_item d-b-c",onClick:k((t=>e.gotoPage("/pages/coupon/detail?coupon_id="+l.coupon_id+"&apply_range="+l.apply_range)),["stop"])},{default:i((()=>[u(v,null,{default:i((()=>[_("仅可购买指定分类商品")])),_:1}),u(v,null,{default:i((()=>[u(C,{class:"icon iconfont icon-jiantou",style:{color:"#999999","font-size":"24rpx"}})])),_:1})])),_:2},1032,["onClick"])):g("",!0)])),_:2},1024)))),128)):g("",!0),u(v,{class:""},{default:i((()=>[u(v,{class:"bottom-refresh"},{default:i((()=>[s.loading?(o(),c(v,{key:0,class:"d-c-c p30"},{default:i((()=>[u(C,{class:"gray3"},{default:i((()=>[_("加载中...")])),_:1})])),_:1})):g("",!0),s.no_more?(o(),c(v,{key:1,class:"d-c-c p30"},{default:i((()=>[u(C,{class:"gray3"},{default:i((()=>[_("~~加载完成~~")])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1}),0!=s.DataList.length||s.loading?g("",!0):(o(),c(v,{key:2,class:"d-c-c p30"},{default:i((()=>[u(C,{class:"iconfont icon-wushuju"}),u(C,{class:"cont"},{default:i((()=>[_("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:2},1024)))),128)):g("",!0)])),_:1})])),_:1},8,["style","onScrolltoupper","onScrolltolower"])])),_:1})}],["__scopeId","data-v-58aa4973"]]);export{x as default};
