import{_ as a,aa as t,J as e,K as s,o as l,c as i,w as o,h as c,d as n,n as d,e as r,t as g,g as p,r as u,F as _,u as m,f,k as h,i as v,l as b,S as y}from"./index-73db7405.js";import{u as w}from"./uni-load-more.e615c410.js";import{_ as k}from"./none.cb4171e5.js";const F=a({components:{uniLoadMore:w},data:()=>({phoneHeight:0,scrollviewHigh:0,state_active:-1,product_id:0,tableData:[],Total:{all:0,negative:0,praise:0,negative:0,review:0},page:1,list_rows:15,no_more:!1,loading:!0,last_page:0,popImg:"",isopenimg:!1}),computed:{loadingType(){return this.loading?1:0!=this.tableData.length&&this.no_more?2:0}},onLoad(a){this.product_id=a.product_id},mounted(){this.init(),this.getData()},methods:{preview(a,t){this.isWeixin()?this.openImg(a,t):(this.isopenimg=!0,this.popImg=t)},openImg(a,e){let s=[];a.forEach(((a,t)=>{s.push(a.file_path)})),t({urls:s,current:e,fail(a){this.showError(a),console.log(a)}})},init(){let a=this;e({success(t){a.phoneHeight=t.windowHeight,s().select(".top-tabbar").boundingClientRect((t=>{let e=a.phoneHeight-t.height;a.scrollviewHigh=e})).exec()}})},getData(){let a=this,t=a.product_id;a._get("product.comment/lists",{product_id:t,scoreType:a.state_active,page:a.page,list_rows:a.list_rows},(function(t){a.loading=!1,a.Total=t.data.total,a.tableData=a.tableData.concat(t.data.list.data),a.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(a.no_more=!0)}))},scrolltolowerFunc(){let a=this;if(a.bottomRefresh=!0,a.page++,a.loading=!0,a.page>a.last_page)return a.loading=!1,void(a.no_more=!0);a.getData()},stateFunc(a){let t=this;t.state_active!=a&&(t.tableData=[],t.no_more=!1,t.loading=!0,t.state_active=a,t.page=1,t.getData())}}},[["render",function(a,t,e,s,w,F){const T=c,D=h,j=v,x=b("uni-load-more"),C=y;return l(),i(T,{class:"look-evaluate"},{default:o((()=>[n(T,{class:"top-tabbar"},{default:o((()=>[n(T,{class:d(-1==w.state_active?"tab-item active":"tab-item"),onClick:t[0]||(t[0]=a=>F.stateFunc(0))},{default:o((()=>[r("全部("+g(w.Total.all)+") ",1)])),_:1},8,["class"]),n(T,{class:d(10==w.state_active?"tab-item active":"tab-item"),onClick:t[1]||(t[1]=a=>F.stateFunc(10))},{default:o((()=>[n(T,{class:"d-c-c"},{default:o((()=>[n(D,{class:"icon iconfont icon-pingjiahaoping"}),n(D,{class:"ml10 gray9"},{default:o((()=>[r("好评("+g(w.Total.praise)+")",1)])),_:1})])),_:1})])),_:1},8,["class"]),n(T,{class:d(20==w.state_active?"tab-item active":"tab-item"),onClick:t[2]||(t[2]=a=>F.stateFunc(20))},{default:o((()=>[n(T,{class:"d-c-c"},{default:o((()=>[n(D,{class:"icon iconfont icon-pingjiazhongping"}),n(D,{class:"ml10 gray9"},{default:o((()=>[r("中评("+g(w.Total.review)+")",1)])),_:1})])),_:1})])),_:1},8,["class"]),n(T,{class:d(30==w.state_active?"tab-item active":"tab-item"),onClick:t[3]||(t[3]=a=>F.stateFunc(30))},{default:o((()=>[n(T,{class:"d-c-c"},{default:o((()=>[n(D,{class:"icon iconfont icon-pingjiachaping"}),n(D,{class:"ml10 gray9"},{default:o((()=>[r("差评("+g(w.Total.negative)+")",1)])),_:1})])),_:1})])),_:1},8,["class"])])),_:1}),n(C,{"scroll-y":"true",class:"scroll-Y",style:m("height:"+w.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:F.scrolltolowerFunc},{default:o((()=>[n(T,{class:"comment-list"},{default:o((()=>[(l(!0),p(_,null,u(w.tableData,((a,t)=>(l(),i(T,{class:"item",key:t},{default:o((()=>[n(T,{class:"cmt-user"},{default:o((()=>[n(T,{class:"left"},{default:o((()=>[n(j,{class:"photo",src:a.users.avatarUrl,mode:"aspectFill"},null,8,["src"]),n(D,{class:"name"},{default:o((()=>[r(g(a.users.nickName),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(T,{class:"d-b-c p20"},{default:o((()=>[n(T,{class:"d-s-c"},{default:o((()=>[10==a.score?(l(),i(T,{key:0,class:"d-c-c mr20"},{default:o((()=>[n(D,{class:"icon iconfont icon-pingjiahaoping"}),n(D,{class:"ml10 gray9"},{default:o((()=>[r("好评")])),_:1})])),_:1})):f("",!0),20==a.score?(l(),i(T,{key:1,class:"d-c-c mr20"},{default:o((()=>[n(D,{class:"icon iconfont icon-pingjiazhongping"}),n(D,{class:"ml10 gray9"},{default:o((()=>[r("中评")])),_:1})])),_:1})):f("",!0),30==a.score?(l(),i(T,{key:2,class:"d-c-c mr20"},{default:o((()=>[n(D,{class:"icon iconfont icon-pingjiachaping"}),n(D,{class:"ml10 gray9"},{default:o((()=>[r("差评")])),_:1})])),_:1})):f("",!0)])),_:2},1024),n(D,{class:"datetime gray9"},{default:o((()=>[r(g(a.create_time),1)])),_:2},1024)])),_:2},1024),n(T,{class:"p-0-20 f24 gray3"},{default:o((()=>[r(g(a.content),1)])),_:2},1024),n(T,{class:"imgs d-s-c p-0-20"},{default:o((()=>[(l(!0),p(_,null,u(a.image,((t,e)=>(l(),i(T,{class:"box",key:e},{default:o((()=>[n(j,{onClick:e=>F.preview(a.image,t.file_path),src:t.file_path,mode:"aspectFill",width:""},null,8,["onClick","src"])])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128)),0!=w.tableData.length||w.loading?(l(),i(x,{key:1,loadingType:F.loadingType},null,8,["loadingType"])):(l(),i(T,{key:0,class:"d-c-c p30"},{default:o((()=>[n(T,{class:"none-data-box"},{default:o((()=>[n(j,{src:k,mode:"widthFix"}),n(D,null,{default:o((()=>[r("亲，暂无相关记录哦")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"]),w.isopenimg?(l(),i(T,{key:0,class:"popimg",onClick:t[4]||(t[4]=a=>w.isopenimg=!1)},{default:o((()=>[n(j,{src:w.popImg,mode:"aspectFit"},null,8,["src"])])),_:1})):f("",!0)])),_:1})}],["__scopeId","data-v-f6faec05"]]);export{F as default};
