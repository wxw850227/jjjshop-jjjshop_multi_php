import{_ as e,V as t,J as s,K as a,B as l,z as o,a as i,a8 as c,U as _,M as d,o as n,c as u,w as p,h as r,d as f,e as h,t as y,f as g,g as m,r as v,F as k,n as b,u as w,i as x,k as C,a0 as L,l as M,S as D,x as q,$ as H}from"./index-73db7405.js";import{u as P}from"./uni-load-more.e615c410.js";const B=e({components:{uniLoadMore:P},data:()=>({isLieBiao:!0,shop_info:"",product_list:"",adList:"",dataList:"",shop_supplier_id:"",isfollow:"",indicatorDots:!1,autoplay:!0,interval:5e3,duration:1e3,listData:[],topRefresh:!1,loading:!0,no_more:!1,type_active:"all",price_top:!1,shopData:[],page:1,search:"",last_page:0,scrollviewHigh:0,nav_type:0,is_open:0,liveList:[],dataModel:{qq:"",wechat:"",phone:""},service_type:0,service_open:1,statusBarHeight:0,titleBarHeight:0}),computed:{loadingType(){return this.loading?1:0!=this.product_list.length&&this.no_more?2:0}},onLoad(e){this.GetStatusBarHeight(),this.shop_supplier_id=e.shop_supplier_id},onShow(){},mounted(){this.getData(),this.getProduct(this.type_active)},onPullDownRefresh(){this.restoreData(),this.getData(),this.getProduct(this.type_active)},methods:{GetStatusBarHeight(){const e=t();this.statusBarHeight=e.statusBarHeight,this.titleBarHeight=30},init(){let e=this;s({success(t){e.phoneHeight=t.windowHeight,a().in(e).select(".shop_head").boundingClientRect((t=>{let s=2*e.phoneHeight-2*t.height-100;e.scrollviewHigh=s,l()})).exec()}})},scrolltolowerFunc(){let e=this;if(e.bottomRefresh=!0,e.page++,e.loading=!0,e.page>e.last_page)return e.loading=!1,void(e.no_more=!0);e.getProduct(e.type_active)},getProduct(e){let t=this,s=t.page;t.loading=!0,t._get("product.product/lists",{page:s||1,sortType:"price",sortPrice:1,sortType:e,shop_supplier_id:t.shop_supplier_id},(function(e){t.loading=!1,t.product_list=[...t.product_list,...e.data.list.data],t.last_page=e.data.list.last_page,e.data.list.last_page<=1&&(t.no_more=!0)}))},restoreData(){this.shopData=[],this.product_list=[],this.page=1,this.category_id=0,this.search="",this.sortType="",this.sortPrice=0},getservice(){let e=this;e.isloding=!0,e._get("index/mpService",{shop_supplier_id:e.shop_supplier_id},(function(t){e.dataModel=t.data.mp_service,e.isloding=!1}))},tabTypeFunc(e){let t=this;e!=t.type_active&&(t.product_list=[],t.page=1,t.no_more=!1,t.loading=!0,t.type_active=e,t.getProduct(e))},getData(){let e=this;e.loading=!0,o({title:"加载中...."}),e._post("supplier.index/index",{shop_supplier_id:e.shop_supplier_id,visitcode:e.getVisitcode()},(t=>{e.loading=!1,e.shop_info=t.data.detail,e.adList=t.data.adList,e.isfollow=t.data.detail.isfollow,e.listData=t.data.couponList,t.data.mp_service?e.service_type=t.data.mp_service.service_type:e.service_type=10,0==e.scrollviewHigh?setTimeout((function(){e.init()}),2001):l(),e.getservice()}))},select_type(){this.isLieBiao=!this.isLieBiao},goto_product(e){this.gotoPage("/pages/product/detail/detail?product_id="+e)},guanzhu(){let e=this;e._post("user.Favorite/add",{pid:e.shop_supplier_id,type:10},(t=>{0==e.isfollow?e.isfollow=1:1==e.isfollow&&(e.isfollow=0)}))},receiveCoupon:function(e){let t=this,s=t.listData[e];if(0==s.state.value)return i({title:"已抢光",icon:"none"}),!1;t._post("user.coupon/receive",{coupon_id:s.coupon_id},(function(e){i({title:"领取成功",icon:"success",mask:!0,duration:2e3}),s.state.value=0,s.state.text="已领取"})),t.getData(t.type_active)},copyQQ(e){var t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("Copy"),document.body.removeChild(t),i({title:"复制成功",icon:"success",mask:!0,duration:2e3})},callPhone(e){c({phoneNumber:e})},toRoom(e){if(""==e.record_url)return!1;this.gotoPage("/pagesLive/live/playback?room_id="+e.room_id)},toSevice(){10==this.service_type||this.shop_info.user_id==_("user_id")?this.nav_type=3:20==this.service_type&&this.gotoPage("/pagesPlus/chat/chat?user_id="+this.shop_info.supplier_user_id+"&shop_supplier_id="+this.shop_info.shop_supplier_id+"&nickName="+this.shop_info.store_name)},goback(){d({})}}},[["render",function(e,t,s,a,l,o){const i=x,c=r,_=C,d=H,P=L,B=M("uni-load-more"),T=D;return n(),u(c,null,{default:p((()=>[f(c,{class:"shop_head"},{default:p((()=>[f(i,{class:"bg_topimg",src:"/h5/assets/background_top-63a861dc.png",mode:""}),f(c,{class:"shop_head_info"},{default:p((()=>[f(c,{class:"shop_list_body_item_shop"},{default:p((()=>[f(c,{class:"shop_list_body_item_shop_logo"},{default:p((()=>[f(i,{src:l.shop_info.logos,mode:""},null,8,["src"])])),_:1}),f(c,{class:"shop_list_body_item_shop_info"},{default:p((()=>[f(c,{class:"h1 white fb title"},{default:p((()=>[h(y(l.shop_info.store_name||""),1)])),_:1}),f(c,{class:"f26 white brand"},{default:p((()=>[h("主营品牌："+y(l.shop_info.category_name||""),1)])),_:1}),f(c,{class:"d-s-c"},{default:p((()=>[f(c,{class:"f22 white sales"},{default:p((()=>[h("销量:"+y(l.shop_info.product_sales||0)+"件",1)])),_:1}),f(c,{class:"f22 white ml30 collect",style:{"text-align":"center"}},{default:p((()=>[h(" 关注: "),f(_,null,{default:p((()=>[h(y(l.shop_info.fav_count||0),1)])),_:1})])),_:1})])),_:1})])),_:1}),f(c,{class:"shop_list_body_item_shop_others"},{default:p((()=>[f(c,{class:"f24 white collect mb30"},{default:p((()=>[h(" 商户评分： "),f(_,null,{default:p((()=>[h(y(l.shop_info.server_score||0),1)])),_:1})])),_:1}),0==l.isfollow?(n(),u(c,{key:0,class:"collect_btn",onClick:t[0]||(t[0]=e=>o.guanzhu())},{default:p((()=>[h("关注")])),_:1})):g("",!0),1==l.isfollow?(n(),u(c,{key:1,class:"collected",onClick:t[1]||(t[1]=e=>o.guanzhu())},{default:p((()=>[h("已关注")])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1}),""!=l.adList&&0==l.nav_type?(n(),u(c,{key:0,class:"shop_head_banner"},{default:p((()=>[f(P,{"indicator-dots":!0,autoplay:!0,interval:3e3,duration:1e3},{default:p((()=>[(n(!0),m(k,null,v(l.adList,((e,t)=>(n(),u(d,{class:"swiper-item",key:t},{default:p((()=>[f(i,{src:e.image&&e.image.file_path,mode:""},null,8,["src"])])),_:2},1024)))),128))])),_:1})])),_:1})):g("",!0),l.listData.length>=1&&2==l.nav_type?(n(),u(c,{key:1,class:"coupon"},{default:p((()=>[f(c,{class:"diy-coupon"},{default:p((()=>[(n(!0),m(k,null,v(l.listData,((t,s)=>(n(),u(c,{class:"mt20 mb20",key:s},{default:p((()=>[f(c,{class:b(["coupon-item","bg-"+t.color.text])},{default:p((()=>[f(c,{class:"side-line left-side-line"},{default:p((()=>[(n(),m(k,null,v(8,((e,t)=>f(_,{class:"round",key:t}))),64))])),_:1}),f(c,{class:"side-line right-side-line"},{default:p((()=>[(n(),m(k,null,v(8,((e,t)=>f(_,{class:"round",key:t}))),64))])),_:1}),f(c,{class:"left-type d-c-c"},{default:p((()=>[h(y(t.coupon_type.text),1)])),_:2},1024),f(c,{class:"center-content pr"},{default:p((()=>[f(c,{class:"content-top"},{default:p((()=>[10==t.coupon_type.value?(n(),m(k,{key:0},[f(_,{class:"f50 fb"},{default:p((()=>[h("减"+y(1*t.reduce_price)+"元",1)])),_:2},1024),t.total_num>=0?(n(),u(_,{key:0,class:"ml10"},{default:p((()=>[h("仅剩"+y(1*t.total_num-1*t.receive_num)+"张",1)])),_:2},1024)):(n(),u(_,{key:1,class:"ml10"},{default:p((()=>[h("不限数量")])),_:1}))],64)):g("",!0),20==t.coupon_type.value?(n(),m(k,{key:1},[f(_,{class:"f50 fb"},{default:p((()=>[h(y(t.discount),1)])),_:2},1024),f(_,null,{default:p((()=>[h("折")])),_:1})],64)):g("",!0)])),_:2},1024),f(c,{class:"content-bottom"},{default:p((()=>[f(_,{class:"f24"},{default:p((()=>[h(y(t.min_price>0?"满￥"+1*t.min_price+"元可用":"无门槛"),1)])),_:2},1024)])),_:2},1024),f(c,{class:"content-datatime"},{default:p((()=>[20==t.expire_type?(n(),m(k,{key:0},[h(" 有效期："+y(t.start_time.text)+" 至 "+y(t.end_time.text),1)],64)):g("",!0),10==t.expire_type?(n(),m(k,{key:1},[h(" 有效期：领取后"+y(t.expire_day)+"天有效 ",1)],64)):g("",!0)])),_:2},1024)])),_:2},1024),0==t.is_get?(n(),u(c,{key:0,class:"right-receive d-c-c",onClick:e=>o.receiveCoupon(s)},{default:p((()=>[h("立即领取")])),_:2},1032,["onClick"])):(n(),u(c,{key:1,class:"right-receive d-c-c"},{default:p((()=>[h("已领取")])),_:1}))])),_:2},1032,["class"]),20==t.apply_range?(n(),u(c,{key:0,class:"range_item d-b-c",onClick:q((s=>e.gotoPage("/pages/coupon/detail?coupon_id="+t.coupon_id)),["stop"])},{default:p((()=>[f(c,null,{default:p((()=>[h("限购商户部分商品")])),_:1}),f(c,null,{default:p((()=>[f(_,{class:"icon iconfont icon-jiantou",style:{color:"#999999","font-size":"24rpx"}})])),_:1})])),_:2},1032,["onClick"])):g("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})):g("",!0),0==l.nav_type?(n(),u(c,{key:2,class:"inner-tab"},{default:p((()=>[f(c,{class:b("all"==l.type_active?"item active":"item"),onClick:t[2]||(t[2]=e=>o.tabTypeFunc("all"))},{default:p((()=>[f(c,{class:"box"},{default:p((()=>[h("综合")])),_:1})])),_:1},8,["class"]),f(c,{class:b("sales"==l.type_active?"item active":"item"),onClick:t[3]||(t[3]=e=>o.tabTypeFunc("sales"))},{default:p((()=>[f(c,{class:"box"},{default:p((()=>[h("销量")])),_:1})])),_:1},8,["class"]),f(c,{class:b("price"==l.type_active?"item active":"item"),onClick:t[4]||(t[4]=e=>o.tabTypeFunc("price"))},{default:p((()=>[f(c,{class:"box"},{default:p((()=>[f(_,null,{default:p((()=>[h("价格")])),_:1})])),_:1})])),_:1},8,["class"]),f(c,{class:"item",onClick:t[5]||(t[5]=e=>o.select_type())},{default:p((()=>[f(c,{class:"box"},{default:p((()=>[f(i,{src:1==l.isLieBiao?"/static/shop/liebiao.png":"/static/shop/tubiao.png"},null,8,["src"])])),_:1})])),_:1})])),_:1})):g("",!0)])),_:1}),2!=l.nav_type?(n(),u(T,{key:0,"scroll-y":"true",style:w("height:"+l.scrollviewHigh+"rpx;"),class:"scroll-Y pr bg-f2","lower-threshold":"50",onScrolltolower:o.scrolltolowerFunc},{default:p((()=>[""!=l.shop_info?(n(),u(c,{key:0,class:"shop"},{default:p((()=>[1==l.isLieBiao&&0==l.nav_type?(n(),u(c,{key:0,class:"shop_body"},{default:p((()=>[(n(!0),m(k,null,v(l.product_list,((e,t)=>(n(),u(c,{class:b(["shop_body_l_item",t==l.listData.length-1?"noborder":""]),key:t,onClick:t=>o.goto_product(e.product_id)},{default:p((()=>[f(c,null,{default:p((()=>[f(i,{src:e.product_image,mode:""},null,8,["src"])])),_:2},1024),f(c,{class:"shop_body_l_item_info"},{default:p((()=>[f(c,{class:"shop_body_l_item_info_title gray3 f32"},{default:p((()=>[h(y(e.product_name),1)])),_:2},1024),f(c,{class:"d-b-c pb10"},{default:p((()=>[f(c,{class:"shop_body_l_item_info_price"},{default:p((()=>[f(c,{class:"f24 shop_red"},{default:p((()=>[h(" ¥ "),f(_,{class:"f32 fb"},{default:p((()=>[h(y(e.product_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),f(c,{class:"shop_body_l_item_info_others f22"},{default:p((()=>[f(c,{class:"shop_body_l_item_info_others_sales"},{default:p((()=>[h("累计成交："+y(e.product_sales)+"笔",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):g("",!0),0==l.isLieBiao&&0==l.nav_type?(n(),u(c,{key:1,class:"shop_body2"},{default:p((()=>[(n(!0),m(k,null,v(l.product_list,((e,t)=>(n(),u(c,{class:"shop_body_t_item",key:t,onClick:t=>o.goto_product(e.product_id)},{default:p((()=>[f(i,{src:e.product_image,mode:""},null,8,["src"]),f(c,{class:"shop_body_t_item_info"},{default:p((()=>[f(c,{class:"shop_body_t_item_info_title h1"},{default:p((()=>[h(y(e.product_name),1)])),_:2},1024),f(c,{class:"shop_body_t_item_info_price"},{default:p((()=>[f(c,{class:"f24 redF6"},{default:p((()=>[h(" ¥ "),f(_,{class:"h1"},{default:p((()=>[h(y(e.product_price),1)])),_:2},1024)])),_:2},1024),f(c,{class:"f24 huaxianjia"},{default:p((()=>[h(" ¥ "),f(_,{class:"h3"},{default:p((()=>[h(y(e.line_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),f(c,{class:"shop_body_t_item_info_others h3"},{default:p((()=>[f(c,{class:"shop_body_t_item_info_others_sales"},{default:p((()=>[h("累计成交："+y(e.product_sales)+"笔",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):g("",!0),1==l.nav_type?(n(),u(c,{key:2},{default:p((()=>[l.liveList.length>0?(n(),u(c,{key:0,class:"live_list"},{default:p((()=>[(n(!0),m(k,null,v(l.liveList,((e,t)=>(n(),u(c,{key:t,class:"live_item",onClick:t=>o.toRoom(e)},{default:p((()=>[""!=e.record_url?(n(),u(c,{key:0,class:"record"},{default:p((()=>[h("可回放")])),_:1})):g("",!0),""==e.record_url?(n(),u(c,{key:1,class:"record_off"},{default:p((()=>[h("回放生成中")])),_:1})):g("",!0),f(c,{class:"live_img"},{default:p((()=>[f(i,{src:e.share.file_path,mode:""},null,8,["src"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):(n(),u(c,{key:1,class:"ww100"},{default:p((()=>[f(c,{class:"f30 gray6 tc mt50 pt20"},{default:p((()=>[h("暂无直播间")])),_:1})])),_:1}))])),_:1})):g("",!0),3==l.nav_type?(n(),u(c,{key:3},{default:p((()=>[e.isloding?g("",!0):(n(),u(c,{key:0,class:"d-s-s d-c p20 mpservice-wrap"},{default:p((()=>[null==l.dataModel||""==l.dataModel.qq&&""==l.dataModel.wechat&&""==l.dataModel.phone?(n(),u(c,{key:0,class:"noDatamodel"},{default:p((()=>[h("该商家尚未设置客服")])),_:1})):g("",!0),null!=l.dataModel?(n(),m(k,{key:1},[""!=l.dataModel.qq?(n(),u(c,{key:0,class:"d-b-c p-30-0 f34 ww100 border-b",onClick:t[6]||(t[6]=e=>o.copyQQ(l.dataModel.qq))},{default:p((()=>[f(_,{class:"gray9",style:{width:"140rpx"}},{default:p((()=>[f(_,{class:"icon iconfont icon-qq"})])),_:1}),f(_,{class:"p-0-30 flex-1"},{default:p((()=>[h(y(l.dataModel.qq),1)])),_:1}),f(_,{class:"blue"},{default:p((()=>[h("复制")])),_:1})])),_:1})):g("",!0),""!=l.dataModel.wechat?(n(),u(c,{key:1,class:"d-b-c p-30-0 f34 ww100 border-b",onClick:t[7]||(t[7]=e=>o.copyQQ(l.dataModel.qq))},{default:p((()=>[f(_,{class:"gray9",style:{width:"140rpx"}},{default:p((()=>[f(_,{class:"icon iconfont icon-weixin"})])),_:1}),f(_,{class:"p-0-30 flex-1"},{default:p((()=>[h(y(l.dataModel.wechat),1)])),_:1}),f(_,{class:"blue"},{default:p((()=>[h("复制")])),_:1})])),_:1})):g("",!0),""!=l.dataModel.phone?(n(),u(c,{key:2,class:"d-b-c p-30-0 f34 ww100",onClick:t[8]||(t[8]=e=>o.callPhone(l.dataModel.phone))},{default:p((()=>[f(_,{class:"gray9",style:{width:"140rpx"}},{default:p((()=>[f(_,{class:"icon iconfont icon-002dianhua"})])),_:1}),f(_,{class:"p-0-30 flex-1"},{default:p((()=>[h(y(l.dataModel.phone),1)])),_:1}),f(_,{class:"blue"},{default:p((()=>[h("拨打")])),_:1})])),_:1})):g("",!0)],64)):g("",!0)])),_:1}))])),_:1})):g("",!0)])),_:1})):g("",!0),0==l.nav_type?(n(),u(c,{key:1},{default:p((()=>[0!=l.product_list.length||l.loading?(n(),u(B,{key:1,loadingType:o.loadingType},null,8,["loadingType"])):(n(),u(c,{key:0,class:"d-c-c p30"},{default:p((()=>[f(_,{class:"iconfont icon-wushuju"}),f(_,{class:"cont"},{default:p((()=>[h("亲，暂无相关记录哦")])),_:1})])),_:1})),f(c,{class:"",style:{width:"100%",height:"100rpx"}})])),_:1})):g("",!0)])),_:1},8,["style","onScrolltolower"])):g("",!0),f(c,{class:"d-a-c nav_bottom"},{default:p((()=>[f(c,{class:b(0==l.nav_type?"active":""),onClick:t[9]||(t[9]=e=>l.nav_type=0)},{default:p((()=>[f(c,{class:"icon iconfont icon-Homehomepagemenu"}),f(c,null,{default:p((()=>[h("首页")])),_:1})])),_:1},8,["class"]),f(c,{class:b(2==l.nav_type?"active":""),onClick:t[10]||(t[10]=e=>l.nav_type=2)},{default:p((()=>[f(c,{class:"icon iconfont icon-quan"}),f(c,null,{default:p((()=>[h("优惠券")])),_:1})])),_:1},8,["class"]),l.service_open?(n(),u(c,{key:0,class:b(3==l.nav_type?"active":""),onClick:o.toSevice},{default:p((()=>[f(c,{class:"icon iconfont icon-kefu2"}),f(c,null,{default:p((()=>[h("客服")])),_:1})])),_:1},8,["class","onClick"])):g("",!0)])),_:1})])),_:1})}],["__scopeId","data-v-c8defc37"]]);export{B as default};
